class NewRandom{constructor(e){this.seed=e}random_dec(){return this.seed^=this.seed<<13,this.seed^=this.seed>>17,this.seed^=this.seed<<5,(this.seed<0?1+~this.seed:this.seed)%1e3/1e3}random_between(e,r){return e+(r-e)*this.random_dec()}random_int(e,r){return Math.floor(this.random_between(e,r+1))}random_choice(e){return e[Math.floor(this.random_between(0,.99*e.length))]}}let hash=tokenData.hash,seed=parseInt(tokenData.hash.slice(0,16),16),R=new NewRandom(seed);function recurseCurve(e,r){if(1===r)return e[e.length-1];if(0===r)return e[0];if(1==e.length)return e[0];for(var t=[],a=1,n=e.length;a<n;a++)t.push(getPoints([e[a-1],e[a]],r));return recurseCurve(t,r)}function getPoints(e,r){var t=e[0][0],a=e[0][1];return[t+(e[1][0]-t)*r,a+(e[1][1]-a)*r]}function inRang(e,r,t){return e>=r&&e<=t}function rotPoints(e,r){var t=PI/180*r,a=cos(t),n=sin(t),s=DEFAULT_SIZE/2;return[a*(e[0]-s)-n*(e[1]-s)+2*s,a*(e[1]-s)+n*(e[0]-s)+s]}function center(e){for(var r=new Array(2),t=2*DEFAULT_SIZE,a=2*DEFAULT_SIZE,n=2*-DEFAULT_SIZE,s=2*-DEFAULT_SIZE,o=0;o<1;o+=.05)r=recurseCurve(e,o),t=min(t,r[0]),a=min(a,r[1]),n=max(n,r[0]),s=max(s,r[1]);for(var i=(t+n)/2,d=(a+s)/2,l=0;l<e.length;l++)e[l][0]=e[l][0]-i+DEFAULT_SIZE/2,e[l][1]=e[l][1]-d+DEFAULT_SIZE/2+2*maxlines}function jitter(e,r){for(var t=R.random_int(0,360),a=0;a<e.length;a++)e[a][0]+=R.random_int(-r,r),e[a][1]+=R.random_int(-r,r),e[a]=rotPoints(e[a],t);return center(e),e}function docord(e,r,t,a,n,s,o){let i=[],d=radians(R.random_between(e-n,e+n)),l=[],h=[];l.push(DEFAULT_SIZE/2+radiLimiter*cos(d)+t),l.push(DEFAULT_SIZE/2+radiLimiter*sin(d)+a),i.push(l),d=radians(R.random_between(0,360));let m=R.random_between(s,o);return h.push(l[0]+m*cos(d)),h.push(l[1]+m*sin(d)),i.push(h),l=[],h=[],d=radians(R.random_between(r-n,r+n)),l.push(DEFAULT_SIZE/2+radiLimiter*cos(d)+t),l.push(DEFAULT_SIZE/2+radiLimiter*sin(d)+a),d=radians(R.random_between(0,360)),m=R.random_between(s,o),h.push(l[0]+m*cos(d)),h.push(l[1]+m*sin(d)),i.push(h),i.push(l),i}let palettes=[];function dripit(e,r){let t=!0;for(;t;){push(),translate(e*Md,(r-4)*Md),stroke(strkColor),strokeWeight(2*Md);let n,s=0,o=R.random_between(-.1,.1),i=R.random_between(2,5),d=R.random_between(30,150),l=R.random_between(.1,.9);for(var a=0;a<=d;a++)n=(1-a/d*l)*i,line(s-n*Md,a*Md,s+n*Md,a*Md),s+=o,R.random_dec()>.9&&(o=R.random_between(-.1*Md,.1*Md));noStroke(),fill(strkColor),ellipse(s,d*Md,R.random_between(3*n,4*n)*Md,R.random_between(3*n,5*n)*Md),pop(),R.random_dec()>.5&&(t=!1)}}palettes.push(["#370617","#6a040f","#9d0208","#d00000","#dc2f02","#e85d04","#f48c06","#faa307","#ffba08"]),palettes.push(["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff"]),palettes.push(["#5f0f40","#9a031e","#fb8b24","#e36414","#0f4c5c"]),palettes.push(["#641220","#6e1423","#85182a","#a11d33","#a71e34","#b21e35","#bd1f36","#c71f37","#da1e37","#e01e37"]),palettes.push(["#39539a","#ffc618","#f50e34","#d4204d"]),palettes.push(["#004b23","#006400","#007200","#008000","#38b000","#70e000","#9ef01a","#ccff33"]),palettes.push(["#fb6107","#f3de2c","#7cb518","#5c8001","#fbb02d"]),palettes.push(["#ff0000","#ff8700","#ffd300","#deff0a","#a1ff0a","#0aff99","#0aefff","#147df5","#580aff","#be0aff"]),palettes.push(["#5bc0eb","#fde74c","#9bc53d","#e55934","#fa7921"]),palettes.push(["#d00000","#ffba08","#3f88c5","#032b43","#136f63"]),palettes.push(["#2364aa","#3da5d9","#73bfb8","#fec601","#ea7317"]),palettes.push(["#ff4800","#ff5400","#ff6000","#ff6d00","#ff7900","#ff8500","#ff9100","#ff9e00","#ffaa00","#ffb600"]),palettes.push(["#ea698b","#d55d92","#c05299","#ac46a1","#973aa8","#822faf","#6d23b6","#6411ad"]),palettes.push(["#e6c229","#f17105","#d11149","#6610f2","#1a8fe3"]),palettes.push(["#f72585","#b5179e","#7209b7","#560bad","#480ca8","#3a0ca3","#3f37c9","#4361ee","#4895ef","#4cc9f0"]),palettes.push(["#9e0059","#ff0054","#ff5400","#ffbd00"]),palettes.push(["#ff6d00","#ff7900","#ff8500","#ff9100","#ff9e00","#5a189a","#7b2cbf","#9d4edd"]),palettes.push(["#ffffff"]);let DIM,WIDTH,HEIGHT,Md,marbleRatio,minBristle,maxBristle,minCurvePoints,maxCurvePoints,radiLimiter,basColor,iter,pointChunk,endChunk,animStep,strkColor,endCounter,numberOfStrokes,ruleVersion,canvasColor,tLA,DEFAULT_SIZE=1e3,special=!1;numberOfStrokes=R.random_dec()>.7?R.random_choice([1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3]):R.random_int(6,25);var brushParts=40;numberOfStrokes<4?R.random_dec()>.3?(special=!0,1==numberOfStrokes?(marbleRatio=R.random_between(2.5,3.5),1==(ruleVersion=R.random_choice([1,2,3]))?(minBristle=40,maxBristle=55,minCurvePoints=2,maxCurvePoints=2):(minBristle=45,maxBristle=70,minCurvePoints=3,maxCurvePoints=3)):2==numberOfStrokes?(marbleRatio=R.random_between(2,3.5),minBristle=35,maxBristle=55,minCurvePoints=2,maxCurvePoints=2,inRang(tLA=R.random_between(0,360),90,120)||inRang(tLA,270,300)?tLA+=30:(inRang(tLA,60,90)||inRang(tLA,240,270))&&(tLA-=30)):(marbleRatio=R.random_between(2.5,4),minBristle=30,maxBristle=60,minCurvePoints=2,maxCurvePoints=2,inRang(tLA=R.random_between(0,360),90,120)||inRang(tLA,270,300)?tLA+=30:(inRang(tLA,60,90)||inRang(tLA,240,270))&&(tLA-=30))):(marbleRatio=R.random_between(1.5,2.5),minBristle=35,maxBristle=45,minCurvePoints=4,maxCurvePoints=8):numberOfStrokes<8?(marbleRatio=R.random_between(2,4),minBristle=25,maxBristle=35,minCurvePoints=4,maxCurvePoints=8):(marbleRatio=R.random_between(2.5,5),minBristle=10,maxBristle=35,minCurvePoints=2,maxCurvePoints=4);let palette=R.random_choice(palettes),huechoice=[1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3],hueMode=R.random_choice(huechoice);var lastx,lasty,maxlines,brushSteps,radis=[],bristleSpacing=4,maxBristleSize=12,pauseShare=.01,blackShare=.2,blackMax=10,minTransShare=.1,phase=[],phLen=[],phStep=[],phBlackTwo=[],phPauseTwo=[],sourceRadi=[],targetRadi=[],thePoints=[],newPoint=[],multiColor=[],endSave=[];function easeInOutQuad(e){return e<.5?2*e*e:1-pow(-2*e+2,2)/2}function moveNext(e,r){4==phase[e]?phase[e]=R.random_choice([2,3]):phase[e]=R.random_choice([2,3,4]),phStep[e]=0,r+minTransShare*brushSteps<phBlackTwo[e]?(phLen[e]=R.random_int(minTransShare*brushSteps,phBlackTwo[e]-r+1),3==phase[e]?targetRadi[e]=R.random_between(radis[e],maxBristleSize):4==phase[e]&&(targetRadi[e]=R.random_between(0,radis[e]))):(phLen[e]=phBlackTwo[e]-r,phase[e]=2),sourceRadi[e]=radis[e]}function brushRow(e,r,t,a,n,s){for(var o,i=0;i<maxlines;i++){o=s<3?i%2==0?r:e:multiColor[i];let d=!0;switch(phStep[i]++,phase[i]){case 0:d=!1,radi=radis[i],phStep[i]>phLen[i]&&(phase[i]=1,phStep[i]=0,phLen[i]=min(blackMax,R.random_int(5,brushSteps*blackShare)),endCounter++,endSave[i]=[t*Md,(a-i*bristleSpacing)*Md]);break;case 1:o=r,radi=radis[i],phStep[i]>phLen[i]&&moveNext(i,n);break;case 2:radi=radis[i],phStep[i]>phLen[i]&&(n>phBlackTwo[i]?(phase[i]=5,phStep[i]=0,phLen[i]=phPauseTwo[i]-phBlackTwo[i]):moveNext(i,n));break;case 3:case 4:radi=map(easeInOutQuad(phStep[i]/phLen[i]),0,1,sourceRadi[i],targetRadi[i]),radi>maxBristleSize&&(radi=maxBristleSize),phStep[i]>phLen[i]&&(radis[i]=radi,n>phBlackTwo[i]?(phase[i]=5,phStep[i]=0,phLen[i]=phPauseTwo[i]-phBlackTwo[i]):moveNext(i,n));break;case 5:radi=radis[i],o=r,radi=radis[i],phStep[i]>=phLen[i]&&(phase[i]=6);break;case 6:d=!1}d&&(fill(o),noStroke(),circle(t*Md,(a-i*bristleSpacing)*Md,radi*Md),redraw())}}function setup(){tWIDTH=window.innerWidth,tHEIGHT=window.innerHeight,DIM=min(tWIDTH,tHEIGHT),Md=DIM/DEFAULT_SIZE,createCanvas(DIM,DIM),colorMode(HSL),canvasColor=color(R.random_int(0,360),30,R.random_int(90,100)),fill(canvasColor),noStroke(),rect(0,0,DIM,DIM),noFill(),smooth(),strokeCap(PROJECT),colorMode(RGB),basColor=color(R.random_choice(palette)),radiLimiter=DEFAULT_SIZE/marbleRatio,iter=0,strokeStage=0}function draw(){if(iter<numberOfStrokes)if(0==strokeStage){strokeStage=1,endCounter=0,curvePoints=2*R.random_int(minCurvePoints,maxCurvePoints),(maxlines=R.random_int(minBristle,maxBristle))%2==0&&maxlines++,brushSteps=floor(2e3*curvePoints/marbleRatio),phase=new Array(maxlines),radis=new Array(maxlines),phStep=new Array(maxlines),phLen=new Array(maxlines),phBlackTwo=new Array(maxlines),phPauseTwo=new Array(maxlines),targetRadi=new Array(maxlines),multiColor=new Array(maxlines),endSave=new Array(maxlines);for(var e=0;e<maxlines;e++)e%2==0?(radis[e]=.9*R.random_between(bristleSpacing,maxBristleSize),0!=e&&e!=maxlines-1||(radis[e]=max(5,radis[e]))):radis[e]=R.random_between(bristleSpacing,maxBristleSize),phase[e]=0,phLen[e]=R.random_int(0,brushSteps*pauseShare),phStep[e]=0,phPauseTwo[e]=R.random_int(brushSteps*(1-pauseShare),brushSteps),phBlackTwo[e]=max(phPauseTwo[e]-blackMax,R.random_int(phPauseTwo[e]-brushSteps*blackShare,phPauseTwo[e]));thePoints=new Array;let n=1;if(special)thePoints=1==numberOfStrokes?1==ruleVersion?docord(0,180,0,maxlines,10,20,150):2==ruleVersion?jitter([[150,650],[1300,-400],[-600,2e3],[850,250],[880,700]],20):jitter([[143,581],[143,1435],[227,79],[428,150],[412,627],[76,1158],[266,1346],[456,417],[770,605]],30):2==numberOfStrokes?1==iter?docord(tLA,tLA+180,0,maxlines,15,50,250):docord(tLA+90,tLA+270,0,maxlines,15,50,250):1==iter?docord(tLA,tLA+180,0,maxlines,5,20,60):2==iter?docord(tLA+30,tLA+150,0,maxlines,5,20,60):docord(tLA-30,tLA+210,0,maxlines,5,20,60);else{for(var r=0;r<curvePoints;r++){let e=radians(R.random_between(0,360));newPoint=new Array,n=0==r||r==curvePoints-1?1:2,newPoint.push(DEFAULT_SIZE/2+radiLimiter*n*cos(e)),newPoint.push(DEFAULT_SIZE/2+radiLimiter*n*sin(e)),thePoints.push(newPoint)}numberOfStrokes<5&&center(thePoints)}switch(strkColor=color("black"),hueMode){case 1:basColor=color(R.random_choice(palette));break;case 2:break;case 3:for(r=0;r<maxlines;r++)multiColor[r]=0==r||r==maxlines-1?color("#000000"):color(R.random_choice(palette))}if(0==iter&&R.random_dec()>.4){let e=R.random_choice([1,1,1,1,1,2,2,2,2,2,2,3]);push(),translate(DIM/2,DIM/2),rotate(R.random_between(0,HALF_PI)),colorMode(RGB),gridColor=color(R.random_choice(palette)),gridColor.setAlpha(R.random_int(50,250)),fill(gridColor),noStroke();let r=R.random_between(3,20)*Md,n=0,s=R.random_between(.4*r,.6*r);for(var t=-DIM;t<2*DIM;t+=r){n=1-n;for(var a=-DIM;a<2*DIM;a+=r)cx=a+.5*r*n,circle(cx,t,s)}if(pop(),2==e)stroke(canvasColor),strokeWeight(DIM),noFill(),circle(DIM/2,DIM/2,3*radiLimiter*Md+DIM);else if(3==e){push(),translate(DIM/2,DIM/2),rotate(R.random_between(0,PI)),noStroke(),rectMode(CORNERS),fill(canvasColor);let e=radiLimiter+R.random_int(-20,20)*Md;rect(DIM/2+e,-DIM,2*DIM,2*DIM),rect(2*-DIM,2*-DIM,DIM/2-e,2*DIM),pop()}}lastx=thePoints[0][0],lasty=thePoints[0][1],pointChunk=floor(brushSteps/brushParts),animStep=0}else{if((endChunk=animStep+pointChunk)>brushSteps&&(endChunk=brushSteps),animStep>.2*brushParts*pointChunk&&animStep<.8*brushParts*pointChunk){let e=special?1/(10*brushParts):5/(10*brushParts);R.random_dec()<e&&dripit(lastx,lasty)}for(e=animStep;e<endChunk;e++){let r=recurseCurve(thePoints,e/brushSteps);brushRow(basColor,strkColor,r[0],r[1],e,hueMode),lastx=r[0],lasty=r[1]}if(endChunk>=brushSteps){if(R.random_dec()>.7){let e=!0,r=1;for(;e;){push(),strokeWeight(8*Md),fill(basColor),stroke(strkColor);const t=recurseCurve(thePoints,.999),a=recurseCurve(thePoints,.98),n=createVector(t[0]*Md,t[1]*Md),s=createVector(a[0]*Md,a[1]*Md),o=p5.Vector.sub(n,s),i=p5.Vector.mult(o,R.random_between(15,50)*r),d=p5.Vector.add(n,i);translate(d),rotate(o.heading()),scale(1,R.random_between(.3,.4));const l=10,h=360/l;splatSize=R.random_between(10,20)*Md/r,beginShape();for(let e=0;e<l+1;e++){const r=splatSize+R.random_between(0,5)*Md,t=e*h,a=cos(radians(t))*r,n=sin(radians(t))*r;curveVertex(a,n)}endShape(CLOSE),pop(),r++,R.random_dec()>.3&&(e=!1)}}strokeStage=0,iter++}else animStep+=pointChunk}else console.log("Done. "+(millis()/1e3).toFixed(2)+"sec."),noLoop()}
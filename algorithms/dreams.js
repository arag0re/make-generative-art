function setup(){DIM=min(window.innerWidth,window.innerHeight,8e3),M=DIM/1e3,createCanvas(DIM,DIM),strokeWeight(1.5),strokeJoin(ROUND),noiseDetail(5);let e=displayDensity();pixelDensity(e),C=[["#B45062","#312E28","#4B7278","#CBC29B","#438839","#AA292D","#BA8B2C","#D97E90"],["#ED254E","#F9C74F","#43AA8B","#003B36","#FFDDE2","#277DA1","#4C1A57","#454851"],["#4F0004","#7A0100","#AD262A","#C3C6A9","#8F7787","#523851","#260910"],["#E9C79E","#B65538","#973E47","#9C61E1","#C487ED","#27474E","#115565"],["#CA2836","#F34C48","#FB7882","#FFF4D6","#000E29"],["#D4E28D","#9BB88C","#89AE9D","#6D8C87","#727B98","#735F7B","#6DC3AA","#3D7A95","#2A4363","#D05F61"],["#FFBD6A","#FE86A0","#83639A","#689A3D","#317849","#FE4465","#002C54","#135569","#EDE2C5"],["#7267C6","#8A86A7","#78B7DE","#B1D9F9","#FEA466","#FCD57D","#F96E66","#CC4D6A"],["#712357","#38213B","#309DA9","#0E837B","#509F46","#8ABA40","#FFD23F","#ED6A5A"],["#C02237","#7B7D32","#5B7833","#195B4D","#193E50"],["#F02733","#FFD605","#396BF5","#FFFFF5","#322D28"],["#40204B","#E09F3D","#ECB75A","#F6D8A7","#E36E77","#A2D2BA"],["#FFFFF5","#0A000A"]],HW=.5*DIM,H=500;let q=R()<.75?H*H:2*H,mi,ma;if(noiseSeed(S[0]),ox=ri(-q,q),oy=ri(-q,q),ci=R()<.5?ri(0,12):ri(0,8),cs=5==ri(0,150)?9:ch([5,15,10]),B=ch([5,30])-1,T=ch([10,30])-1,q=ch([2]),de=1==q?15:11,n=1==T?de:de+1,v=ch([3,10,30]),2==v?(mi=.05,ma=.1):3==v?(mi=.3,ma=.45):(mi=.15,ma=.25),A=1==v?0==T?.001:0:round(rb(mi,ma),2),J=R()<.25?round(rb(.001,.02),4):round(rb(.001,.008),4),D=R()<.5?ri(3,n-1):ri(5,n-1),Z=1!=v&&5==ri(0,15),ii=[],9==cs)C=shp(C),c=C[0];else if(1==cs){let t=shp(C[ci]);c=[t[0],t[1]]}else if(2==cs){let i1=ri(0,12),i2=ri(0,12);for(;i2==i1;)i2=ri(0,12);cc=[shp(C[i1]),shp(C[i2])],c=cc[0],ii=[i1,i2]}else c=shp(C[ci]);O=[];for(let i=0;i<n;i++)O.push(ri(0,2));L=[];let p=0,t=0;for(let i=0;i<n;i++){let u=ri(0,1);u==p?t++:t=0,t>2&&(u=0==p?1:0,t=0),L.push(u),p=u}a=[],z=0,cn=[],md=20}function draw(){clear(),z=0,cn=[],md=20,translate(HW,HW),scale(M),sd({x:-H,y:-H},{x:H,y:-H},{x:H,y:H},{x:-H,y:H},n,a);for(let r of a){r.d<md&&(md=r.d),inc(cn,r.c)||cn.push(r.c),noFill(),stroke(r.c),beginShape();for(let p of r.p)vertex(p.x,p.y);endShape(CLOSE)}for(let r of a){fill(r.c),noStroke(),beginShape();for(let p of r.p)vertex(p.x,p.y);endShape(CLOSE)}noLoop()}function sd(p1,p2,p3,p4,n,a,hr=!1,d=0){let c1=c[d%c.length],c2=c[(d+z)%c.length],p01,p02,p03,p04,p11,p12,p13,p14,w1=dv(p1,p2),w2=dv(p4,p3),h1=dv(p1,p4),h2=dv(p2,p3),w0=max(w1,w2),h0=max(h1,h2),a1,a2,g,cv,t1,t2,r0,r1,r;g=mp(p1,p3),9==cs?(nvt=noise(.003*(g.x+ox),.003*(g.y+oy))>.5?g.x+ox:g.y+oy,cv=floor(12*noise(.005*nvt))):cv=floor(12*noise(.003*(g.x+ox),.003*(g.y+oy))),0==T&&(hr=w0>h0),2==cs&&(c=cv<6?cc[0]:cc[1]),9==cs&&(c=C[cv]),z=3==cs?(z+1)%c.length:1,a1=.5+mn(p1.x,p1.y,A),a2=.5+mn(p4.x,p4.y,A),Z&&(a2=a1),hr?(t1=mp(p1,p2,a1),t2=mp(p4,p3,a2),p01=p1,p02={x:t1.x,y:t1.y},p03={x:t2.x,y:t2.y},p04=p4,p11=p02,p12=p2,p13=p3,p14=p03):(t1=mp(p2,p3,a1),t2=mp(p1,p4,a2),p01=p1,p02=p2,p03={x:t1.x,y:t1.y},p04={x:t2.x,y:t2.y},p11=p04,p12=p03,p13=p3,p14=p4),d++,T>1&&(hr=!hr),1==T&&(hr=0!=L[d]),r0={p:[p01,p02,p03,p04],c:c1,d:d},r1={p:[p11,p12,p13,p14],c:c2,d:d};let q=0==B?0:10;d<n&&w0>q&&h0>q?(r=d<D?2:0==B?O[d]:1==B?floor(5*noise((w1+ox)*J,(h2+oy)*J,d)):floor(5*noise((p01.x+ox)*J,(p11.y+oy)*J)),(0==r||r>1)&&sd(p01,p02,p03,p04,n,a,hr,d),(1==r||r>1)&&sd(p11,p12,p13,p14,n,a,hr,d),0==r&&a.push(r1),1==r&&a.push(r0)):a.push(r0,r1)}function shp(p){let c=[],f=[];arrayCopy(p,c);let l=p.length;for(let t=0;t<l;t++){let i=ri(0,c.length-1);f.push(c[i]),c.splice(i,1)}return f}function inc(a,e){if(0==a.length)return!1;for(let i=0;i<a.length;i++)if(a[i]==e)return!0;return!1}function ch(a){let r=ri(0,100),o=0,i=1;for(let u of a){if(r>o-1&&r<u+o)return i;i++,o+=u}return i}function windowResized(){DIM=Math.min(window.innerWidth,window.innerHeight),M=DIM/1e3,HW=.5*DIM,resizeCanvas(DIM,DIM)}S=Uint32Array.from([0,1,s=t=2,3].map(i=>parseInt(tokenData.hash.substr(8*i+2,8),16))),
R=_=>(t=S[3],S[3]=S[2],S[2]=S[1],S[1]=s=S[0],t^=t<<11,S[0]^=t^t>>>8^s>>>19,S[0]/2**32),
'ty @piterpasma'
rb=(a,b)=>a+(b-a)*R(),ri=(a,b)=>floor(rb(a,b+1)),rc=a=>a[floor(rb(0,.99*a.length))],dv=(i,j)=>dist(i.x,i.y,j.x,j.y),mn=(i,j,o)=>map(noise((i+ox)*J,(j+oy)*J),0,1,-o,o),mp=(i,j,a=.5)=>({x:lerp(i.x,j.x,a),y:lerp(i.y,j.y,a)});
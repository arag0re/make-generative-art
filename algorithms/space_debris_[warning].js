let seed=parseInt(tokenData.hash.slice(0,16),16);class Lagrange{constructor(t,r){this.w=t,this.h=r,this.debris=[]}}class Palette{constructor(t,r=1){this.c=t,this.repeat=r,this.i=0,this.u=0}increment(){this.i==this.c.length-1?this.i=0:this.i+=1}usage(){this.u%this.repeat==0&&this.increment(),this.u+=1}color(){return this.usage(),this.c[this.i]}}var DIM_C=Math.min(window.innerWidth,window.innerHeight),DIM=1.3*DIM_C,DIM_EXT=1.5*DIM_C,M=DIM/1e3;function n(t){return t*DIM/1e3}var SPACE,GTYPE=1,COMPLEXITY_P1=.7,COMPLEXITY_P2=.5,MIN_H=n(3),MAX_H=n(rnd_num(50,200)),MIN_W=n(3),MAX_W=n(rnd_num(50,200)),STEP_MIN=n(50),STEP_MAX=n(100),BREAK_SLICE=rnd_int(1,5),STROKE_WIDTH=n(rnd_int(2,4)),BLOCKS_P1=rnd_num(.8,1),BLOCKS_P2=rnd_num(.8,1),DEBRIS_P=rnd_int(25,50),FLIP_P1=.1,FLIP_P2=.1,INVERT_P1=rnd_arr([.8,1]),INVERT_P2=rnd_arr([.8,1]),STYLE_P=1,GLYPH_P=rnd_num(.5,1),GLYPH_VERTEX=rnd_num(3,5),GRAVITY=.1,P1_REP=rnd_int(1,5),P2_REP=rnd_int(1,5),P3_REP=rnd_int(1,5),PALS=[[["Cyber"],["#F72585","#B5179E","#7209B7","#4361EE","#4361EE","#4895EF","#4CC9F0"]],[["Pulp"],["#19172C","#E3C0A2","#A54F50","#A12A32","#2F3279","#3FB5C9","#F9D067"]],[["Essence"],["#63345E","#FD8090","#B7C1DE","#06569C","#092047"]],[["Voyage"],["#E96D5E","#EEEEEE","#FFE69D","#6A7E6A","#393F5F"]],[["Moonrise"],["#FF0000","#00A08A","#F2AD00","#F98400","#5BBCD6"]],[["Cult"],["#040404","#DE8C9D","#FE2858","#2AF0EA","#397684"]],[["Eternity"],["#FF0000","#00A08A","#F2AD00","#F98400","#5BBCD6"]]],BG="#000003",PAL_C=rnd_arr(PALS),PAL=PAL_C[1],P1=new Palette(PAL,repeat=P1_REP),P2=new Palette(PAL,repeat=P2_REP),P3=new Palette(PAL,repeat=P3_REP),OBJECTS=[];function setup(){createCanvas(DIM_C,DIM_C),background(BG),rr(0,0,DIM,DIM),frameRate(30),draw_objects(OBJECTS);class t{constructor(t,r){this.w=t,this.h=r,this.fill=P3.color(),this.stroke=BG,this.stroke_width=STROKE_WIDTH/3,this.points=[[-1,-1],[1,-1],[1,1],[-1,1]],this.a=createVector(0,0),this.v=createVector(rnd_num(n(-1),n(1)),rnd_num(n(-1),n(1))),this.p=createVector(rnd_num(0,this.w),rnd_num(0,this.h)),this.r=1,this.dx=rnd_num(.3,2.5),this.dy=rnd_num(.3,10),this.maxspeed=n(5),this.maxforce=n(.1)}}SPACE=new Lagrange(DIM_EXT,DIM_EXT);for(let r=0;r<DEBRIS_P;r++){let r=new t(SPACE.w,SPACE.h);if(rnd_num()>GLYPH_P){let t=[];for(let r=0;r<GLYPH_VERTEX;r++)t.push([rnd_arr([-1,1]),rnd_arr([-1,1])]);r.points=t}SPACE.debris.push(r)}}function draw(){background(BG),draw_objects(OBJECTS);for(let t=0;t<SPACE.debris.length;t++){let r=SPACE.debris[t];compute(r,SPACE.debris),update(r),wrap(r),render(r)}}function force(t,r){t.a.add(r)}function compute(t,r){force(t,dark_matter(t,r).mult(GRAVITY))}function render(t){let r=t.v.heading()+radians(90);push(),translate(t.p.x,t.p.y),rotate(r),fill(t.fill),stroke(t.stroke),strokeWeight(t.stroke_width),strokeJoin(ROUND);let e=t.points;beginShape();for(let r=0;r<e.length;r++){let i=t.r+n(5)*e[r][0]*t.dx,s=t.r+n(5)*e[r][1]*t.dy;vertex(i,s)}endShape(CLOSE),pop()}function dark_matter(t,r){let e=createVector(0,0),i=0;for(let s=0;s<r.length;s++){let _=p5.Vector.dist(t.p,r[s].p);_>n(0)&&_<n(50)&&(e.add(r[s].p),i++)}return i>0?(e.div(i),attract(t,e)):createVector(0,0)}function update(t){t.v.add(t.a),t.v.limit(t.maxspeed),t.p.add(t.v),t.a.mult(0)}function attract(t,r){let e=p5.Vector.sub(r,t.p);e.normalize(),e.mult(t.maxspeed);let n=p5.Vector.sub(e,t.v);return n.limit(t.maxforce),n}function wrap(t){let r=n(50);t.p.x<-t.r*r&&(t.p.x=t.w+t.r*r),t.p.y<-t.r*r&&(t.p.y=t.h+t.r*r),t.p.x>t.w+t.r*r&&(t.p.x=-t.r*r),t.p.y>t.h+t.r*r&&(t.p.y=-t.r*r)}function rr(t,r,e,n){rnd_num()>COMPLEXITY_P1&&rect_partition(t,r,t+e,r+n);var i=rnd_num()>COMPLEXITY_P2,s=rnd_num();i&&e>rnd_num(MIN_W,MAX_W)?(rr(t,r,e*s,n),rr(t+e*s,r,e*(1-s),n)):n>rnd_num(MIN_H,MAX_H)&&(rr(t,r,e,n*s),rr(t,r+n*s,e,n*(1-s)))}function rect_partition(t,r,e,n){let i=range(t,e,rnd_num(STEP_MIN,STEP_MAX)).slice(BREAK_SLICE),s=rnd_num()>FLIP_P1,_=rnd_num()>FLIP_P2,o=rnd_num()>INVERT_P1,d=rnd_num()>INVERT_P2,a=rnd_num()>STYLE_P;if(rnd_num()>BLOCKS_P1){let i=P1.color();OBJECTS.push(create_obj(t,r,e-t,n-r,i,BG,STROKE_WIDTH,invert=o)),s&&OBJECTS.push(create_obj(t,r,e-t,n-r,i,BG,STROKE_WIDTH,flip=!0,invert=o))}for(let e of i){if(rnd_num()>BLOCKS_P2){let i=P2.color();OBJECTS.push(create_obj(t,r,e-t,n-r,i,BG,STROKE_WIDTH,invert=d,a=a)),_&&OBJECTS.push(create_obj(t,r,e-t,n-r,i,BG,STROKE_WIDTH,flip=!0,invert=d,a=a))}t=e}}function create_obj(t,r,e,n,i,s,_,o=!1,d=!1,a=!1){return o?{x1:r,y1:t,xs:n,ys:e,fill:i,stroke:s,stroke_width:_,invert:d,style:a}:{x1:t,y1:r,xs:e,ys:n,fill:i,stroke:s,stroke_width:_,invert:d,style:a}}function draw_objects(t){strokeJoin(MITER);for(let r=0;r<t.length;r++){let e=t[r];if(e.invert?(fill(e.stroke),stroke(e.fill),strokeWeight(e.stroke_width/2)):(fill(e.fill),stroke(e.stroke),strokeWeight(e.stroke_width)),rect(e.x1,e.y1,e.xs,e.ys),e.style){e.x2=e.x1+e.xs,e.y2=e.y1+e.ys;for(let t=e.y1;t<e.y2;t+=n(12))for(let r=e.x1;r<e.x2;r+=n(12))fill(e.stroke),stroke(e.stroke),strokeWeight(n(7)),rect(r,t,n(3.5),n(3.5))}}}function range(t,r,e){let n=[t],i=t;for(;i<r;)n.push(i+=e||1);return i>r?n.slice(0,-1):n}function rnd_dec(){return seed^=seed<<13,seed^=seed>>17,((seed^=seed<<5)<0?1+~seed:seed)%1e3/1e3}function rnd_num(t=0,r=1){return t+(r-t)*rnd_dec()}function rnd_int(t=0,r=1){return Math.floor(rnd_num(t,r+1))}function rnd_arr(t){return t[Math.floor(rnd_num(0,.99*t.length))]}

let seed=parseInt(tokenData.hash.slice(0,16),16);class Lagrange{constructor(t,e){this.w=t,this.h=e,this.debris=[]}}class Palette{constructor(t,e=1){this.c=t,this.repeat=e,this.i=0,this.u=0}increment(){this.i==this.c.length-1?this.i=0:this.i+=1}usage(){this.u%this.repeat==0&&this.increment(),this.u+=1}color(){return this.usage(),this.c[this.i]}}var DIM_C=Math.min(window.innerWidth,window.innerHeight),DIM=1.3*DIM_C,DIM_EXT=1.5*DIM_C,M=DIM/1e3;function n(t){return t*DIM/1e3}var SPACE,GTYPE=0,COMPLEXITY_P1=.7,COMPLEXITY_P2=.5,MIN_H=n(3),MAX_H=n(rnd_num(100,500)),MIN_W=n(3),MAX_W=n(rnd_num(50,500)),STEP_MIN=n(50),STEP_MAX=n(100),BREAK_SLICE=rnd_int(1,5),STROKE_WIDTH=n(rnd_int(5,7)),BLOCKS_P1=rnd_num(.6,.8),BLOCKS_P2=rnd_num(.6,.8),DEBRIS_P=rnd_int(15,40),FLIP_P1=0,FLIP_P2=0,INVERT_P1=1,INVERT_P2=1,STYLE_P=1,GLYPH_P=rnd_num(.5,1),GLYPH_VERTEX=rnd_num(3,5),GRAVITY=0,P1_REP=rnd_int(1,5),P2_REP=rnd_int(1,5),P3_REP=rnd_int(1,5),PALS=[[["Neopunk"],["#08F7FE","#09FBD3","#FE53BB","#F5D300"]],[["Sentinel"],["#D9EB4B","#00A9FE","#FD6BB6","#EF0888"]],[["Neopunk"],["#08F7FE","#09FBD3","#FE53BB","#F5D300"]],[["Viper"],["#E92EFB","#FF2079","#440BD4","#04005E"]],[["Dust"],["#845EC2","#4B4453","#B0A8B9","#FF8066"]],[["Rushmore"],["#B0305C","#EB564B","#73275C"]],[["Pokie"],["#3AC9CE","#413BCF","#D9EB4B"]],[["Cream"],["#44CCFF","#FFF1D0","#343432"]],[["Lightyear"],["#E6DDCE","#70C7DB","#C0A95B"]],[["Lavandula"],["#F4F9F9","#7289DA","#D3D3D3"]],[["Budapest"],["#E6A0C4","#C6CDF7","#D8A499","#7294D4"]]],BG="#000003",PAL_C=rnd_arr(PALS),PAL=PAL_C[1],P1=new Palette(PAL,repeat=P1_REP),P2=new Palette(PAL,repeat=P2_REP),P3=new Palette(PAL,repeat=P3_REP),OBJECTS=[];function setup(){createCanvas(DIM_C,DIM_C),background(BG),rr(0,0,DIM,DIM),frameRate(30),draw_objects(OBJECTS);class t{constructor(t,e){this.w=t,this.h=e,this.fill=P3.color(),this.stroke=BG,this.stroke_width=STROKE_WIDTH/3,this.points=[[-1,-1],[1,-1],[1,1],[-1,1]],this.a=createVector(0,0),this.v=createVector(rnd_num(n(-1),n(1)),rnd_num(n(-1),n(1))),this.p=createVector(rnd_num(0,this.w),rnd_num(0,this.h)),this.r=1,this.dx=rnd_num(.3,2.5),this.dy=rnd_num(.3,10),this.maxspeed=n(5),this.maxforce=n(.1)}}SPACE=new Lagrange(DIM_EXT,DIM_EXT);for(let e=0;e<DEBRIS_P;e++){let e=new t(SPACE.w,SPACE.h);if(rnd_num()>GLYPH_P){let t=[];for(let e=0;e<GLYPH_VERTEX;e++)t.push([rnd_arr([-1,1]),rnd_arr([-1,1])]);e.points=t}SPACE.debris.push(e)}}function draw(){background(BG),draw_objects(OBJECTS);for(let t=0;t<SPACE.debris.length;t++){let e=SPACE.debris[t];compute(e,SPACE.debris),update(e),wrap(e),render(e)}}function force(t,e){t.a.add(e)}function compute(t,e){force(t,dark_matter(t,e).mult(GRAVITY))}function render(t){let e=t.v.heading()+radians(90);push(),translate(t.p.x,t.p.y),rotate(e),fill(t.fill),stroke(t.stroke),strokeWeight(t.stroke_width),strokeJoin(ROUND);let r=t.points;beginShape();for(let e=0;e<r.length;e++){let i=t.r+n(5)*r[e][0]*t.dx,s=t.r+n(5)*r[e][1]*t.dy;vertex(i,s)}endShape(CLOSE),pop()}function dark_matter(t,e){let r=createVector(0,0),i=0;for(let s=0;s<e.length;s++){let _=p5.Vector.dist(t.p,e[s].p);_>n(0)&&_<n(50)&&(r.add(e[s].p),i++)}return i>0?(r.div(i),attract(t,r)):createVector(0,0)}function update(t){t.v.add(t.a),t.v.limit(t.maxspeed),t.p.add(t.v),t.a.mult(0)}function attract(t,e){let r=p5.Vector.sub(e,t.p);r.normalize(),r.mult(t.maxspeed);let n=p5.Vector.sub(r,t.v);return n.limit(t.maxforce),n}function wrap(t){let e=n(50);t.p.x<-t.r*e&&(t.p.x=t.w+t.r*e),t.p.y<-t.r*e&&(t.p.y=t.h+t.r*e),t.p.x>t.w+t.r*e&&(t.p.x=-t.r*e),t.p.y>t.h+t.r*e&&(t.p.y=-t.r*e)}function rr(t,e,r,n){rnd_num()>COMPLEXITY_P1&&rect_partition(t,e,t+r,e+n);var i=rnd_num()>COMPLEXITY_P2,s=rnd_num();i&&r>rnd_num(MIN_W,MAX_W)?(rr(t,e,r*s,n),rr(t+r*s,e,r*(1-s),n)):n>rnd_num(MIN_H,MAX_H)&&(rr(t,e,r,n*s),rr(t,e+n*s,r,n*(1-s)))}function rect_partition(t,e,r,n){let i=range(t,r,rnd_num(STEP_MIN,STEP_MAX)).slice(BREAK_SLICE),s=rnd_num()>FLIP_P1,_=rnd_num()>FLIP_P2,o=rnd_num()>INVERT_P1,d=rnd_num()>INVERT_P2,a=rnd_num()>STYLE_P;if(rnd_num()>BLOCKS_P1){let i=P1.color();OBJECTS.push(create_obj(t,e,r-t,n-e,i,BG,STROKE_WIDTH,invert=o)),s&&OBJECTS.push(create_obj(t,e,r-t,n-e,i,BG,STROKE_WIDTH,flip=!0,invert=o))}for(let r of i){if(rnd_num()>BLOCKS_P2){let i=P2.color();OBJECTS.push(create_obj(t,e,r-t,n-e,i,BG,STROKE_WIDTH,invert=d,a=a)),_&&OBJECTS.push(create_obj(t,e,r-t,n-e,i,BG,STROKE_WIDTH,flip=!0,invert=d,a=a))}t=r}}function create_obj(t,e,r,n,i,s,_,o=!1,d=!1,a=!1){return o?{x1:e,y1:t,xs:n,ys:r,fill:i,stroke:s,stroke_width:_,invert:d,style:a}:{x1:t,y1:e,xs:r,ys:n,fill:i,stroke:s,stroke_width:_,invert:d,style:a}}function draw_objects(t){strokeJoin(MITER);for(let e=0;e<t.length;e++){let r=t[e];if(r.invert?(fill(r.stroke),stroke(r.fill),strokeWeight(r.stroke_width/2)):(fill(r.fill),stroke(r.stroke),strokeWeight(r.stroke_width)),rect(r.x1,r.y1,r.xs,r.ys),r.style){r.x2=r.x1+r.xs,r.y2=r.y1+r.ys;for(let t=r.y1;t<r.y2;t+=n(12))for(let e=r.x1;e<r.x2;e+=n(12))fill(r.stroke),stroke(r.stroke),strokeWeight(n(7)),rect(e,t,n(3.5),n(3.5))}}}function range(t,e,r){let n=[t],i=t;for(;i<e;)n.push(i+=r||1);return i>e?n.slice(0,-1):n}function rnd_dec(){return seed^=seed<<13,seed^=seed>>17,((seed^=seed<<5)<0?1+~seed:seed)%1e3/1e3}function rnd_num(t=0,e=1){return t+(e-t)*rnd_dec()}function rnd_int(t=0,e=1){return Math.floor(rnd_num(t,e+1))}function rnd_arr(t){return t[Math.floor(rnd_num(0,.99*t.length))]}

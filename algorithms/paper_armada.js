let seed=generateSeedFromTokenData(tokenData);const rng=rnd;let scale,baseVector;window.onload=function(){var e=document.createElement("canvas");const n=4*Math.min(window.innerWidth,window.innerHeight);if(e.width=n,e.height=n,e.setAttribute("style","width:"+n/4+"px; height:"+n/4+"px;"),scale=n/1e3,document.body.appendChild(e),e.getContext){var t=e.getContext("2d");const n=w_pick([{u1:-.04,u2:.38},{u1:1.04,u2:.62},{u1:-.1,u2:.4},{u1:1.1,u2:.6},{u1:0,u2:.5}],[16,8,4,2,1]);baseVector={u1:[Math.cos(n.u1*Math.PI),Math.sin(n.u1*Math.PI)],u2:[Math.cos(n.u2*Math.PI),Math.sin(n.u2*Math.PI)]};const l=w_pick([0,1,2,3,4,5],[60,15,15,6,3,1]),a=get_palette(),s=w_pick(["random","group","main","single"],[4,16,4,1]),u=w_pick([!0,!1],[1,4]),h=w_pick([!0,!1],0==l||5===l?[1,9]:[9,1]),f=w_pick([!0,!1],[1,19]),p=w_pick([.2,.5,.75],[1,4,1]),g=[{name:"trooper",rows:1,columns:3,pad_x:38,cell_size:18,radius_x:pick([12,14,16]),radius_y:pick([16,18,20,22]),block_size:.78,equal_rows:!1,double:!1},{name:"convoy",rows:1,columns:2,pad_x:45,pad_y:25,radius_x:10,radius_y:24,double:!0,rows2:1,columns2:1,radius_x2:6,radius_y2:12,block_size2:.72},{name:"carrier",rows:2,columns:pick([2,3,4]),pad_x:15,pad_y:50,radius_x:5,radius_y:8,block_size:.72,double:!0,rows2:1,columns2:1,radius_x2:26,radius_y2:10},{name:"cruiser",rows:pick([2,3]),columns:2,pad_x:55,pad_y:25,radius_x:6,radius_y:8,block_size:.72,double:!0,rows2:1,columns2:1,radius_x2:14,radius_y2:30},{name:"mothership",radius_x:36,radius_y:28,double:!1},{name:"swarm",rows:7,columns:7,pad_x:16,pad_x:16,cell_size:12,radius_x:5,radius_y:5,block_size:.68,double:!1}][l];let m={rows:g.rows||1,columns:g.columns||1,padding_x:g.pad_x||20,padding_y:g.pad_y||20,cell_size:g.cell_size||16,cell_pad:-2,radius_x:g.radius_x,radius_y:g.radius_y,h_symmetric:!0,v_symmetric:f,simple:!1,roundness:0,solidness:pick([.5,.8,1]),compactness:1,block_size:g.block_size||.8,chance_vertical:p,display_fill:!0,palette:a,color_mode:s,group_size:.65,use_simplex:!1,rate_of_change:.05,equal_rows:h,ethereal:u};var o={...m,radius_x:g.radius_x2,radius_y:g.radius_y2,rows:g.rows2||1,columns:g.columns2||1,block_size:g.block_size2||.8};const b=i(c(m),m.equal_rows,m.columns,m.rows),w=g.double?i(c(o),o.equal_rows,o.columns,o.rows):null;!function(n,t,o){let c=o*scale,i=e.width,l=e.height;n.clearRect(0,0,i,l),n.fillStyle=t,n.globalAlpha=1,n.fillRect(0,0,i,l);const r=10*c,a=[i/2,l/2],s=[];for(var u=-20;u<=20;u++){n.beginPath();var h=d(a[0]+u*r,-l),f=d(a[0]+u*r,2*l);s.push(roughLine(h,f,4*o))}for(var u=-20;u<=20;u++){n.beginPath();var h=d(2*-i,a[1]+u*r),f=d(2*i,a[1]+u*r);s.push(roughLine(h,f,4*o))}n.lineCap="square",n.lineWidth=2*scale,n.globalAlpha=.2,s.forEach(e=>_(n,e,null,"#fff",!1))}(t,m.palette.b,m.cell_size+m.cell_pad),function(n,t){let o=e.width,c=e.height;n.beginPath(),n.moveTo(0,0),n.lineTo(o,0),n.lineTo(o,c),n.lineTo(0,c),n.lineTo(0,0),n.closePath(),n.moveTo(t,t),n.lineTo(t,c-t),n.lineTo(o-t,c-t),n.lineTo(o-t,t),n.lineTo(t,t),n.closePath(),n.fillStyle="#000",n.globalAlpha=1,n.fill()}(t,25*scale),r(t,b,m),g.double&&r(t,w,o)}function c(e){let n={initiate_chance:e.compactness,extension_chance:e.block_size,vertical_chance:e.chance_vertical,horizontal_symmetry:e.h_symmetric,vertical_symmetry:e.v_symmetric,simple:e.simple,roundness:e.roundness,solidness:e.solidness,colors:e.palette.c,color_mode:e.color_mode,group_size:e.group_size,rng:rng};return new Apparatus(e.radius_x,e.radius_y,n)}function i(e,n,t,o){let c,i=[];for(let r=0;r<o;r++){let o=[];n&&(c=e.generate(null,null,!1,r,0));for(let i=0;i<t;i++)n||(c=e.generate(null,null,!1,r*t+i,0)),o.push(c.map(l));i.push(o)}return i}function l(e){const n=rng();return{...e,shade:n<.3?-1:n<.7?0:1,col:rng()<.001?pick(get_palette().c):e.col}}function r(n,t,o){let c=o.padding_x,i=o.padding_y,l=o.columns,r=o.rows;const s=e.height/2;n.save(),n.translate(s,s);var u=(o.cell_size+o.cell_pad)*scale,_=[c*(l-1)/2*u,i*(r-1)/2*u],h=d(c,0),f=d(0,i);for(let e=0;e<r;e++){n.save();for(let c=0;c<l;c++)n.lineCap="square",n.lineWidth=1.5*scale,a(n,t[e][c],o,_),n.translate(h[0]*u,h[1]*u);n.restore(),n.translate(f[0]*u,f[1]*u)}n.restore()}function a(e,n,t,o){e.save();const{cell_size:c,cell_pad:i,display_fill:l,ethereal:r,v_symmetric:a}=t;var d=(c+i)*scale;let h=function(e){const n=2*e.radius_x+11,t=2*e.radius_y+11;return[n+2,t+2]}(t);const f=n.map(e=>{const n=u(e.x1,e.y1,h,a);return{...e,points:s(n[0]*d-o[0],n[1]*d-o[1],e.w*d-i*scale,e.h*d-i*scale),shade_mid_points:s(n[0]*d-o[0]-4*scale,n[1]*d-o[1]-4*scale,e.w*d-(i-8)*scale,e.h*d-(i-8)*scale),shade_points:s((n[0]-.8)*d-o[0],(n[1]+1)*d-o[1],e.w*d-i*scale,e.h*d-i*scale)}});l&&(e.globalCompositeOperation="normal",e.globalAlpha=1,f.forEach(n=>{_(e,n.shade_points,"#000",null,!1)}),f.forEach(n=>{_(e,n.shade_mid_points,r?"#000":"#fff",null,!1)}),e.globalCompositeOperation=r?"screen":"multiply",f.forEach(n=>{_(e,n.points,n.col,null,!0)})),e.globalCompositeOperation="overlay",e.globalAlpha=.2,f.forEach(n=>{if(0!==n.shade){const t=u(n.x1,n.y1,h,a),c=s(t[0]*d-o[0],t[1]*d-o[1],n.w*d-i,n.h*d-i);e.lineCap="round",_(e,c,1===n.shade?"#fff":"#000",null,!1)}}),e.restore()}function s(e,n,t,o){const c=d(e,n),i=d(e+t,n),l=d(e+t,n+o),r=d(e,n+o);return[...roughLine(c,i),...roughLine(i,l),...roughLine(l,r),...roughLine(r,c)]}function d(e,n){var t=baseVector.u1,o=baseVector.u2;return[e*t[0]+n*o[0],e*t[1]+n*o[1]]}function u(e,n,t,o){return[e-t[0]/2,n-(o?t[1]/2:6*t[1]/11)]}function _(e,n,t,o,c){e.beginPath(),e.moveTo(n[0].a[0],n[0].a[1]);for(let t=1;t<n.length;t++){let o=n[t-1],c=n[t];e.bezierCurveTo(o.cp2?o.cp2[0]:o.a[0],o.cp2?o.cp2[1]:o.a[1],c.cp1?c.cp1[0]:c.a[0],c.cp1?c.cp1[1]:c.a[1],c.a[0],c.a[1])}null!=t&&(e.fillStyle=t,e.fill()),null!=o&&(e.strokeStyle=o,e.stroke())}};class Apparatus{constructor(e,n,{initiate_chance:t=.8,extension_chance:o=.8,vertical_chance:c=.8,horizontal_symmetry:i=!0,vertical_symmetry:l=!1,roundness:r=.1,solidness:a=.5,colors:s=[],color_mode:d="group",group_size:u=.8,simple:_=!1,simplex:h=null,rate_of_change:f=.01,rng:p=null}={}){this.xdim=Math.round(2*e+11,0),this.ydim=Math.round(2*n+11,0),this.radius_x=e,this.radius_y=n,this.chance_new=t,this.chance_extend=o,this.chance_vertical=c,this.colors=s,this.color_mode=d,this.group_size=u,this.h_symmetric=i,this.v_symmetric=l,this.roundness=r,this.solidness=a,this.simple=_,this.simplex=h,this.rate_of_change=f,this.rng=p}generate(e=null,n=null,t=!1,o=0,c=0){this.idx=o,this.idy=c,this.main_color=this.get_random(this.colors),this.id_counter=0;let i=new Array(this.ydim+1);for(var l=0;l<i.length;l++){i[l]=new Array(this.xdim+1);for(var r=0;r<i[l].length;r++)0==l||0==r?i[l][r]={h:!1,v:!1,in:!1,col:null}:1==l&&null!=e?i[l][r]={...e[r],h:!0}:1==r&&null!=n?i[l][r]={...n[l],v:!0}:this.h_symmetric&&r>i[l].length/2?(i[l][r]=deep_copy(i[l][i[l].length-r]),i[l][r].v=i[l][i[l].length-r+1].v):this.v_symmetric&&l>i.length/2?(i[l][r]=deep_copy(i[i.length-l][r]),i[l][r].h=i[i.length-l+1][r].h):i[l][r]=this.next_block(r,l,i[l][r-1],i[l-1][r])}let a=convert_linegrid_to_rectangles(i);return t?[a,i]:a}next_block(e,n,t,o){const c=this;if(!t.in&&!o.in)return function(e,n){return a(e,n)?r():{v:!1,h:!1,in:!1,col:null,id:null}}(e,n);if(t.in&&!o.in)return t.h?function(e,n){return d(e,n)?{v:!1,h:!0,in:!0,col:t.col,id:t.id}:i(e,n)}(e,n):i(e,n);if(!t.in&&o.in)return o.v?function(e,n){return d(e,n)?{v:!0,h:!1,in:!0,col:o.col,id:o.id}:l(e,n)}(e,n):l(e,n);if(t.in&&o.in)return t.h||o.v?t.h&&!o.v?function(e,n){return d(e,n)?{v:!1,h:!0,in:!0,col:t.col,id:t.id}:s(e,n)?r():{v:!0,h:!0,in:!1,col:null,id:null}}(e,n):!t.h&&o.v?function(e,n){return d(e,n)?{v:!0,h:!1,in:!0,col:o.col,id:o.id}:s(e,n)?r():{v:!0,h:!0,in:!1,col:null,id:null}}(e,n):c.rng()<=c.chance_vertical?{v:!0,h:!1,in:!0,col:o.col,id:o.id}:{v:!1,h:!0,in:!0,col:t.col,id:t.id}:{v:!1,h:!1,in:!0,col:t.col,id:t.id};function i(e,n){return a(e,n)?r():{v:!0,h:!1,in:!1,col:null,id:null}}function l(e,n){return a(e,n)?r():{v:!1,h:!0,in:!1,col:null,id:null}}function r(){let e;if("random"===c.color_mode)e=c.get_random(c.colors);else if("main"===c.color_mode)e=c.rng()>.75?c.get_random(c.colors):c.main_color;else if("group"===c.color_mode){let n=c.rng()>.5?t.col:o.col;c.main_color=c.rng()>c.group_size?c.get_random(c.colors):n||c.main_color,e=c.main_color}else e=c.main_color;return{v:!0,h:!0,in:!0,col:e,id:c.id_counter++}}function a(e,n){return!!c.simple||!!u(e,n,-1*(1-c.roundness))&&c.rng()<=c.solidness}function s(e,n){return!!c.simple||!!u(e,n,0)&&c.rng()<=c.chance_new}function d(e,n){return!(!u(e,n,1-c.roundness)&&!c.simple)&&c.rng()<=c.chance_extend}function u(e,n,t){let o=1+c.rng()*t;return Math.pow(e-c.xdim/2,2)/Math.pow(c.radius_x*o,2)+Math.pow(n-c.ydim/2,2)/Math.pow(c.radius_y*o,2)<1}}get_random(e){return e[Math.floor(this.rng()*e.length)]}}function deep_copy(e){let n=[];for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function convert_linegrid_to_rectangles(e){let n=get_nw_corners(e);return extend_corners_to_rectangles(n,e),n}function get_nw_corners(e){let n=[];for(let t=0;t<e.length;t++)for(let o=0;o<e[t].length;o++){let c=e[t][o];c.h&&c.v&&c.in&&n.push({x1:o,y1:t,col:c.col,id:c.id})}return n}function extend_corners_to_rectangles(e,n){e.map(e=>{let t=1;for(;e.x1+t<n[e.y1].length&&!n[e.y1][e.x1+t].v;)t++;let o=1;for(;e.y1+o<n.length&&!n[e.y1+o][e.x1].h;)o++;return e.w=t,e.h=o,e})}const init_accuracy=Math.PI/25;function roughLine(e,n,t=35){const o=t*scale;const c=[{a:e,cp1:null,cp2:null}];for(;0!=dist(c[c.length-1].a,n)&&c.length<200;){const e=getNextPoint(c,o,n);c.push(e)}return c}function getNextPoint(e,n,t){let o=e[e.length-1].a,c=dist(o,t),i=e[0].a,l=c/dist(i,t),r=n*(.5*rng()+1);if(c<=1.5*r)return{a:t,cp1:null,cp2:null};let a=l*init_accuracy,s=angle_of_direction(o,t),d=rng()*a-a/2,u=point_at_distance_and_angle(o,r,s+d);return{a:u,cp1:point_at_distance_towards_direction(u,-r/3,t),cp2:point_at_distance_towards_direction(u,Math.min(r,dist(u,t))/3,t)}}const dist=(e,n)=>Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)),angle_of_direction=(e,n)=>Math.atan2(n[1]-e[1],n[0]-e[0]),point_at_distance_and_angle=(e,n,t)=>[e[0]+n*Math.cos(t),e[1]+n*Math.sin(t)],point_at_distance_towards_direction=(e,n,t)=>point_at_distance_and_angle(e,n,angle_of_direction(e,t));function rnd(){seed^=seed<<13,seed^=seed>>17;const e=((seed^=seed<<5)<0?1+~seed:seed)%1e5/1e5;return 0===e||1===e?.5:e}function range(e,n){return void 0===n&&(n=e,e=0),rng()*(n-e)+e}function rangeFloor(e,n){return Math.floor(range(e,n))}function pick(e){if(0!==e.length)return e[rangeFloor(0,e.length)]}function w_pick(e,n){const t=n.reduce((e,n)=>[...e,e[e.length-1]+n],[0]),o=range(t[t.length-1]);return e[t.findIndex(e=>e>o)-1]}function generateSeedFromTokenData(e){return parseInt(e.hash.slice(0,16),16)}function get_palette(){var e=[{c:["#f1594a","#f5b50e","#14a160","#2969de","#885fa4"],b:"#e2e6e8",w:1},{c:["#ed555d","#41b797","#eda126","#7b5770"],b:"#2d1922",w:1},{c:["#ec6c26","#613a53","#e8ac52","#639aa0"],b:"#d5cda1",w:2},{c:["#809498","#d3990e","#ecddc5"],b:"#863f52",w:2},{c:["#6b5c6e","#4a2839","#d9574a"],b:"#ffc34b",w:2},{c:["#c37c2b","#f6ecce","#386a7a"],b:"#e3cd98",w:2},{c:["#4bae8c","#d0c1a0"],b:"#d06440",w:2},{c:["#d24c23","#7ba6bc","#f0c667","#ede2b3","#672b35"],b:"#108266",w:1},{c:["#e3937b","#d93f1d","#e6cca7"],b:"#558947",w:1},{c:["#d03718","#33762f","#ead7c9","#ce7028","#689d8d"],b:"#deb330",w:2},{c:["#eb5627","#eebb20","#4e9eb8","#f7f5d0"],b:"#77c1c0",w:3},{c:["#ff6555","#ffb58f","#d8eecf","#8c4b47","#bf7f93"],b:"#ffda82",w:1},{c:["#475b62","#7a999c","#fbaf3c","#df4a33","#f0e0c6","#af592c"],b:"#f0e0c6",w:3},{c:["#e85b30","#ef9e28","#c6ac71","#e0c191","#3f6279","#ee854e"],b:"#ede4cb",w:2},{c:["#c03a53","#edd09e","#aab5af","#124639","#eba735","#8e9380","#6c4127"],b:"#e6e2d6",w:2},{c:["#f4b232","#f2dbbd","#01799c","#e93e48","#006748","#ed817d","#2a2969"],b:"#f2dbbd",w:1},{c:["#FF514E","#FDBC2E","#4561CC","#6CC283","#238DA5","#9BD7CB"],b:"#2A303E",w:1},{c:["#ea663f","#f9cc27","#84afd7","#7ca994","#f1bbc9"],b:"#f5f6f1",w:2},{c:["#ff7a5a","#765aa6","#fee7bc","#515e8c","#ffc64a","#b460a6","#4781c1"],b:"#abe9e8",w:3},{c:["#ae5d9d","#f1e8bc","#ef8fa3","#f7c047","#58c9ed","#f77150"],b:"#00ae83",w:3},{c:["#FFC54A","#fee7bc","#54C4C6","#4781C1","#F36E4B","#515F8C"],b:"#FE98A6",w:3},{c:["#F99854","#fee7bc","#54C4C6","#6CC4EA","#F496A6","#B461A5"],b:"#FFC649",w:3},{c:["#36AA85","#043554","#FA3E2C","#F99D7F","#147562","#026F36"],b:"#022626",w:2},{c:["#D14991","#F6D031","#F0645B","#D2E4CE"],b:"#2C134C",w:2},{c:["#E59040","#DD4C2F","#106381","#F8B8B9","#018A82","#B4AFAB","#8DB4B9","#53293D","#2BAABB"],b:"#DBB560",w:3}];return w_pick(e,e.map(e=>e.w))}
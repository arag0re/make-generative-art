let seed=parseInt(tokenData.hash.slice(0,16),16);class Lagrange{constructor(r,t){this.w=r,this.h=t,this.debris=[]}}class Palette{constructor(r,t=1){this.c=r,this.repeat=t,this.i=0,this.u=0}increment(){this.i==this.c.length-1?this.i=0:this.i+=1}usage(){this.u%this.repeat==0&&this.increment(),this.u+=1}color(){return this.usage(),this.c[this.i]}}var DIM_C=Math.min(window.innerWidth,window.innerHeight),DIM=1.3*DIM_C,DIM_EXT=1.5*DIM_C,M=DIM/1e3;function n(r){return r*DIM/1e3}var GTYPE=2,COMPLEXITY_P1=.7,COMPLEXITY_P2=.5,MIN_H=n(3),MAX_H=n(rnd_num(10,50)),MIN_W=n(3),MAX_W=MAX_H,STEP_MIN=n(20),STEP_MAX=n(50),BREAK_SLICE=rnd_int(1,5),STROKE_WIDTH=n(rnd_int(2,10)),BLOCKS_P1=1,BLOCKS_P2=rnd_num(.7,.9),DEBRIS_P=rnd_int(50,100),FLIP_P1=.1,FLIP_P2=.1,INVERT_P1=1,INVERT_P2=1,STYLE_P=rnd_arr([1,rnd_num(.5,1)]),GLYPH_P=rnd_num(.25,.75),GLYPH_VERTEX=rnd_num(3,5),GRAVITY=.75,P1_REP=rnd_arr([1,2,5,25]),P2_REP=rnd_arr([1,2,5,25]),P3_REP=rnd_arr([1,2,5,25]);rnd_num()>.95&&(INVERT_P1=0,INVERT_P2=0,STYLE_P=1);var SPACE,PALS=[[["Jade Theory"],["#EEEEEE","#CC0E74"]],[["Invaders"],["#363636","#E8175D"]],[["B/W"],["#EEEEEE","#000003"]],[["Azure"],["#FF184C","#FF184C","#0A9CF5"]],[["Hive"],["#F2D39F","#2A1F30"]],[["Love"],["#D1ADEF","#80D9FF"]],[["Virgo"],["#E8175D","#D8A499"]],[["Moon"],["#B8C7C4","#435060"]],[["Indigo"],["#FF7477","#484D7A"]],[["Golden"],["#FFB511","#914E72"]],[["Aqua"],["#82D8D5","#5EC8E5"]],[["Icy"],["#EFEFEF"]]],BG="#000003",PAL_C=rnd_arr(PALS),PAL=PAL_C[1],P1=new Palette(PAL,repeat=P1_REP),P2=new Palette(PAL,repeat=P2_REP),P3=new Palette(PAL,repeat=P3_REP),OBJECTS=[];function setup(){createCanvas(DIM_C,DIM_C),background(BG),rr(0,0,DIM,DIM),frameRate(30),draw_objects(OBJECTS);class r{constructor(r,t){this.w=r,this.h=t,this.fill=P3.color(),this.stroke=BG,this.stroke_width=STROKE_WIDTH/3,this.points=[[-1,-1],[1,-1],[1,1],[-1,1]],this.a=createVector(0,0),this.v=createVector(rnd_num(n(-1),n(1)),rnd_num(n(-1),n(1))),this.p=createVector(rnd_num(0,this.w),rnd_num(0,this.h)),this.r=1,this.dx=rnd_num(.3,2.5),this.dy=rnd_num(.3,10),this.maxspeed=n(5),this.maxforce=n(.1)}}SPACE=new Lagrange(DIM_EXT,DIM_EXT);for(let t=0;t<DEBRIS_P;t++){let t=new r(SPACE.w,SPACE.h);if(rnd_num()>GLYPH_P){let r=[];for(let t=0;t<GLYPH_VERTEX;t++)r.push([rnd_arr([-1,1]),rnd_arr([-1,1])]);t.points=r}SPACE.debris.push(t)}}function draw(){background(BG),draw_objects(OBJECTS);for(let r=0;r<SPACE.debris.length;r++){let t=SPACE.debris[r];compute(t,SPACE.debris),update(t),wrap(t),render(t)}}function force(r,t){r.a.add(t)}function compute(r,t){force(r,dark_matter(r,t).mult(GRAVITY))}function render(r){let t=r.v.heading()+radians(90);push(),translate(r.p.x,r.p.y),rotate(t),fill(r.fill),stroke(r.stroke),strokeWeight(r.stroke_width),strokeJoin(ROUND);let e=r.points;beginShape();for(let t=0;t<e.length;t++){let i=r.r+n(5)*e[t][0]*r.dx,_=r.r+n(5)*e[t][1]*r.dy;vertex(i,_)}endShape(CLOSE),pop()}function dark_matter(r,t){let e=createVector(0,0),i=0;for(let _=0;_<t.length;_++){let s=p5.Vector.dist(r.p,t[_].p);s>n(0)&&s<n(50)&&(e.add(t[_].p),i++)}return i>0?(e.div(i),attract(r,e)):createVector(0,0)}function update(r){r.v.add(r.a),r.v.limit(r.maxspeed),r.p.add(r.v),r.a.mult(0)}function attract(r,t){let e=p5.Vector.sub(t,r.p);e.normalize(),e.mult(r.maxspeed);let n=p5.Vector.sub(e,r.v);return n.limit(r.maxforce),n}function wrap(r){let t=n(50);r.p.x<-r.r*t&&(r.p.x=r.w+r.r*t),r.p.y<-r.r*t&&(r.p.y=r.h+r.r*t),r.p.x>r.w+r.r*t&&(r.p.x=-r.r*t),r.p.y>r.h+r.r*t&&(r.p.y=-r.r*t)}function rr(r,t,e,n){rnd_num()>COMPLEXITY_P1&&rect_partition(r,t,r+e,t+n);var i=rnd_num()>COMPLEXITY_P2,_=rnd_num();i&&e>rnd_num(MIN_W,MAX_W)?(rr(r,t,e*_,n),rr(r+e*_,t,e*(1-_),n)):n>rnd_num(MIN_H,MAX_H)&&(rr(r,t,e,n*_),rr(r,t+n*_,e,n*(1-_)))}function rect_partition(r,t,e,n){let i=range(r,e,rnd_num(STEP_MIN,STEP_MAX)).slice(BREAK_SLICE),_=rnd_num()>FLIP_P1,s=rnd_num()>FLIP_P2,o=rnd_num()>INVERT_P1,d=rnd_num()>INVERT_P2,a=rnd_num()>STYLE_P;if(rnd_num()>BLOCKS_P1){let i=P1.color();OBJECTS.push(create_obj(r,t,e-r,n-t,i,BG,STROKE_WIDTH,invert=o)),_&&OBJECTS.push(create_obj(r,t,e-r,n-t,i,BG,STROKE_WIDTH,flip=!0,invert=o))}for(let e of i){if(rnd_num()>BLOCKS_P2){let i=P2.color();OBJECTS.push(create_obj(r,t,e-r,n-t,i,BG,STROKE_WIDTH,invert=d,a=a)),s&&OBJECTS.push(create_obj(r,t,e-r,n-t,i,BG,STROKE_WIDTH,flip=!0,invert=d,a=a))}r=e}}function create_obj(r,t,e,n,i,_,s,o=!1,d=!1,a=!1){return o?{x1:t,y1:r,xs:n,ys:e,fill:i,stroke:_,stroke_width:s,invert:d,style:a}:{x1:r,y1:t,xs:e,ys:n,fill:i,stroke:_,stroke_width:s,invert:d,style:a}}function draw_objects(r){strokeJoin(MITER);for(let t=0;t<r.length;t++){let e=r[t];if(e.invert?(fill(e.stroke),stroke(e.fill),strokeWeight(e.stroke_width/2)):(fill(e.fill),stroke(e.stroke),strokeWeight(e.stroke_width)),rect(e.x1,e.y1,e.xs,e.ys),e.style){e.x2=e.x1+e.xs,e.y2=e.y1+e.ys;for(let r=e.y1;r<e.y2;r+=n(12))for(let t=e.x1;t<e.x2;t+=n(12))fill(e.stroke),stroke(e.stroke),strokeWeight(n(7)),rect(t,r,n(3.5),n(3.5))}}}function range(r,t,e){let n=[r],i=r;for(;i<t;)n.push(i+=e||1);return i>t?n.slice(0,-1):n}function rnd_dec(){return seed^=seed<<13,seed^=seed>>17,((seed^=seed<<5)<0?1+~seed:seed)%1e3/1e3}function rnd_num(r=0,t=1){return r+(t-r)*rnd_dec()}function rnd_int(r=0,t=1){return Math.floor(rnd_num(r,t+1))}function rnd_arr(r){return r[Math.floor(rnd_num(0,.99*r.length))]}

var Dlny;(function(){"use strict";var EPSILON=1/1048576;function supertriangle(vertices){var xmin=Number.POSITIVE_INFINITY,ymin=Number.POSITIVE_INFINITY,xmax=Number.NEGATIVE_INFINITY,ymax=Number.NEGATIVE_INFINITY,i,dx,dy,dmax,xmid,ymid;for(i=vertices.length;i--;){if(vertices[i][0]<xmin)xmin=vertices[i][0];if(vertices[i][0]>xmax)xmax=vertices[i][0];if(vertices[i][1]<ymin)ymin=vertices[i][1];if(vertices[i][1]>ymax)ymax=vertices[i][1]}dx=xmax-xmin;dy=ymax-ymin;dmax=Math.max(dx,dy);xmid=xmin+dx*.5;ymid=ymin+dy*.5;return[[xmid-20*dmax,ymid-dmax],[xmid,ymid+20*dmax],[xmid+20*dmax,ymid-dmax]]}function circumcircle(vertices,i,j,k){var x1=vertices[i][0],y1=vertices[i][1],x2=vertices[j][0],y2=vertices[j][1],x3=vertices[k][0],y3=vertices[k][1],fabsy1y2=Math.abs(y1-y2),fabsy2y3=Math.abs(y2-y3),xc,yc,m1,m2,mx1,mx2,my1,my2,dx,dy;if(fabsy1y2<EPSILON&&fabsy2y3<EPSILON)return;if(fabsy1y2<EPSILON){m2=-((x3-x2)/(y3-y2));mx2=(x2+x3)/2;my2=(y2+y3)/2;xc=(x2+x1)/2;yc=m2*(xc-mx2)+my2}else if(fabsy2y3<EPSILON){m1=-((x2-x1)/(y2-y1));mx1=(x1+x2)/2;my1=(y1+y2)/2;xc=(x3+x2)/2;yc=m1*(xc-mx1)+my1}else{m1=-((x2-x1)/(y2-y1));m2=-((x3-x2)/(y3-y2));mx1=(x1+x2)/2;mx2=(x2+x3)/2;my1=(y1+y2)/2;my2=(y2+y3)/2;xc=(m1*mx1-m2*mx2+my2-my1)/(m1-m2);yc=fabsy1y2>fabsy2y3?m1*(xc-mx1)+my1:m2*(xc-mx2)+my2}dx=x2-xc;dy=y2-yc;return{i:i,j:j,k:k,x:xc,y:yc,r:dx*dx+dy*dy}}function dedup(edges){var i,j,a,b,m,n;for(j=edges.length;j;){b=edges[--j];a=edges[--j];for(i=j;i;){n=edges[--i];m=edges[--i];if(a===m&&b===n||a===n&&b===m){edges.splice(j,2);edges.splice(i,2);break}}}}Dlny={triang:function(vertices,key){var n=vertices.length,i,j,indices,st,open,closed,edges,dx,dy,a,b,c;if(n<3)return[];vertices=vertices.slice(0);if(key)for(i=n;i--;)vertices[i]=vertices[i][key];indices=new Array(n);for(i=n;i--;)indices[i]=i;indices.sort(function(i,j){return vertices[j][0]-vertices[i][0]});st=supertriangle(vertices);vertices.push(st[0],st[1],st[2]);var circCircle=circumcircle(vertices,n+0,n+1,n+2);if(circCircle==undefined)return[];open=[circumcircle(vertices,n+0,n+1,n+2)];closed=[];edges=[];for(i=indices.length;i--;edges.length=0){c=indices[i];for(j=open.length;j--;){dx=vertices[c][0]-open[j].x;if(dx>0&&dx*dx>open[j].r){closed.push(open[j]);open.splice(j,1);continue}dy=vertices[c][1]-open[j].y;if(dx*dx+dy*dy-open[j].r>EPSILON)continue;edges.push(open[j].i,open[j].j,open[j].j,open[j].k,open[j].k,open[j].i);open.splice(j,1)}dedup(edges);for(j=edges.length;j;){b=edges[--j];a=edges[--j];open.push(circumcircle(vertices,a,b,c))}}for(i=open.length;i--;)closed.push(open[i]);open.length=0;for(i=closed.length;i--;)if(closed[i].i<n&&closed[i].j<n&&closed[i].k<n)open.push(closed[i].i,closed[i].j,closed[i].k);return open},contains:function(tri,p){if(p[0]<tri[0][0]&&p[0]<tri[1][0]&&p[0]<tri[2][0]||p[0]>tri[0][0]&&p[0]>tri[1][0]&&p[0]>tri[2][0]||p[1]<tri[0][1]&&p[1]<tri[1][1]&&p[1]<tri[2][1]||p[1]>tri[0][1]&&p[1]>tri[1][1]&&p[1]>tri[2][1])return null;var a=tri[1][0]-tri[0][0],b=tri[2][0]-tri[0][0],c=tri[1][1]-tri[0][1],d=tri[2][1]-tri[0][1],i=a*d-b*c;if(i===0)return null;var u=(d*(p[0]-tri[0][0])-b*(p[1]-tri[0][1]))/i,v=(a*(p[1]-tri[0][1])-c*(p[0]-tri[0][0]))/i;if(u<0||v<0||u+v>1)return null;return[u,v]}};if(typeof module!=="undefined")module.exports=Dlny})();p5.disableFriendlyErrors=true;const PYWR=1<<4;const PSZ=4095;const scl_cos=i=>.5*(1-Math.cos(i*Math.PI));class Rnd{constructor(seed){this.seed=seed;this.perlin=null}rnd_dec(){this.seed^=this.seed<<13;this.seed^=this.seed>>17;this.seed^=this.seed<<5;return(this.seed<0?~this.seed+1:this.seed)%1e3/1e3}rnd_btw(a,b){return a+(b-a)*this.rnd_dec()}rnd_int(a,b){return Math.floor(this.rnd_btw(a,b+1))}rnd_chc(x){return x[Math.floor(this.rnd_btw(0,x.length*.99))]}noise(x,y){if(this.perlin==null){this.perlin=new Array(PSZ+1);for(let i=0;i<PSZ+1;i++){this.perlin[i]=this.rnd_dec()}}if(x<0){x=-x}if(y<0){y=-y}let xi=Math.floor(x),yi=Math.floor(y);let xf=x-xi;let yf=y-yi;let rxf,ryf;let r=0;let ampl=.5;let n1,n2,n3;for(let o=0;o<4;o++){let of=xi+(yi<<4);rxf=scl_cos(xf);ryf=scl_cos(yf);n1=this.perlin[of&PSZ];n1+=rxf*(this.perlin[of+1&PSZ]-n1);n2=this.perlin[of+PYWR&PSZ];n2+=rxf*(this.perlin[of+PYWR+1&PSZ]-n2);n1+=ryf*(n2-n1);n2=this.perlin[of&PSZ];n2+=rxf*(this.perlin[of+1&PSZ]-n2);n3=this.perlin[of+PYWR&PSZ];n3+=rxf*(this.perlin[of+PYWR+1&PSZ]-n3);n2+=ryf*(n3-n2);n1+=n2-n1;r+=n1*ampl;ampl*=.5;xi<<=1;xf*=2;yi<<=1;yf*=2;if(xf>=1){xi++;xf--}if(yf>=1){yi++;yf--}}return r}}var rand;var size;var data;var pts;var pts2;function points_generator(number,cx,cy,sx,sy){mapp=[];pts=[];for(var i=0;i<number;i++){var point={x:rand.rnd_btw(-sx,sx),y:rand.rnd_btw(-sy,sy),mult_x:rand.rnd_btw(1,4),mult_y:rand.rnd_btw(1,4),var_x:rand.rnd_btw(-size/2,size/2),var_y:rand.rnd_btw(-size/2,size/2)};point1={};Object.assign(point1,point);point1["x"]=cx-point["x"];point1["y"]=cy-point["y"];pts[i]=point1}for(var i=0;i<pts.length;i++){mapp[i]=[pts[i]["x"],pts[i]["y"]]}data=Dlny.triang(mapp);return}var nflw;var cf1;var cf2;var bw;var cc;var ccc;var b1;var b2;var xl;var yl;var circ;var dots;function setup(){size=windowHeight>windowWidth?windowWidth:windowHeight;createCanvas(size,size);rand=new Rnd(parseInt(tokenData.hash.slice(2,10),16));bw=createGraphics(size,size);size=width/4.1;nflw=rand.rnd_int(0,1);cf1=rand.rnd_btw(1e-4,.001);cf2=rand.rnd_btw(1e-4,.001);b1=rand.rnd_int(0,1);b2=rand.rnd_int(0,1);bk=rand.rnd_chc([0,0,0,0,255]);cc=rand.rnd_int(0,8);wg=width*1.3;hg=height*1.3;wp=wg/400;hp=hg/120;wvp=rand.rnd_int(1,3);wvm=rand.rnd_chc([-4,-3,-2,-1,0,0,1,2,3,4]);wvf=rand.rnd_btw(1e-4,.2);offx=-width*.15;offy=-height*.15;sym=rand.rnd_int(0,1);ctl=rand.rnd_chc([0,0,0,0,1]);yl=rand.rnd_chc([1,2,3,4,5,6,7,8,9,10,25,50,100]);xl=rand.rnd_chc([20,21,22,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,70,100]);circ=rand.rnd_int(0,1);dots=rand.rnd_int(0,1);if(cc==6){sng=rand.rnd_int(1,3);var rr=sng==1?rand.rnd_int(200,255):rand.rnd_int(50,255);var gg=sng==2?rand.rnd_int(200,255):rand.rnd_int(50,255);var bb=sng==3?rand.rnd_int(200,255):rand.rnd_int(50,255);var modr=sng==1?1:rand.rnd_chc([-1,1]);var modg=sng==2?1:rand.rnd_chc([-1,1]);var modb=sng==3?1:rand.rnd_chc([-1,1])}pts=[];pts2=[];if(ctl){cx=width/2;cy=height/2;sx=width/10;sy=height/10;ppp=200}else{cx=width/2*b1+width/4;cy=height/2*b2+height/4;sx=width/30;sy=height/30;ppp=100}points_generator(ppp,cx,cy,sx,sy);bw.background(bk);for(var f=0;f<120;f++){bw.noStroke();bw.fill(bk);bw.drawingContext.shadowBlur=0;lines=[];for(var i=0;i<401;i++){lines.push(rand.noise(f/yl,i/xl)*Math.pow(Math.sin(Math.PI/400*wvm*i+f*wvf),wvp))}bw.beginShape();bw.vertex(offx,offy+hp*f+hg/2);for(var i=0;i<401;i++){bw.vertex(offx+wp*i,offy+hp*f-size/2*lines[i])}bw.vertex(offx+wp*401,offy+hp*f+hg/2);bw.endShape(CLOSE);bw.noFill();bw.strokeWeight(size/150);for(var i=0;i<400;i++){nn=lines[i];nnn=lines[i+1];bw.drawingContext.shadowBlur=size/15;if(cc==0){ccc=color(255*nn,200-200*nn,150+105*nn)}else if(cc==1){ccc=color(80+175*nn)}else if(cc==2){ccc=color(180,0,70+185*nn)}else if(cc==3){ccc=color(255*nn,100+155*nn,200+55*nn)}else if(cc==4){ccc=color(255*nn,100+155*nn,50-50*nn)}else if(cc==5){ccc=color(100+155*nn,60-60*nn,200-200*nn)}else if(cc==6){ccc=color(rr/2+modr*rr/2*nn,gg/2+modg*gg/2*nn,bb/2+modb*bb/2*nn)}else if(cc==7){ccc=color(100+155*nn,0,0)}else if(cc=8){ccc=color(0,100+155*nn,0)}bw.drawingContext.shadowColor=ccc;bw.stroke(ccc);bw.line(offx+wp*i,offy+hp*f-size/2*nn,offx+wp*(i+1),offy+hp*f-size/2*nnn)}}}var drw=true;var time=true;var t;function draw(){drawingContext.shadowBlur=0;image(bw,0,0);if(drw){if(time){t=millis()}drawingContext.shadowBlur=size/15+size/60*rand.rnd_dec();if(cc==1){ccc=red(ccc)<80?color(80):ccc}else if(cc==7){ccc=red(ccc)<80?color(80,0,0):ccc}else if(cc==8){ccc=green(ccc)<80?color(0,80,0):ccc}drawingContext.shadowColor=color(ccc);stroke(ccc);fill(bk,150);strokeWeight(size/100);if(ctl){cx=width/2;cy=height/2;w=width*.5;h=height*.5}else{cx=width/2*b1+width/4;cy=height/2*b2+height/4;w=width*.35;h=height*.35}rectMode(CENTER);if(circ){circle(cx,cy,w)}else{rect(cx,cy,w,h)}if(nflw){noStroke();if(bk==255){cccn=color(255)}else{cccn=color(0);cccn.setRed(red(ccc)/3);cccn.setGreen(green(ccc)/3);cccn.setBlue(blue(ccc)/3)}fill(cccn)}else{noFill();strokeWeight(size/300)}pts2=[];for(var i=0;i<pts.length;i++){p=pts[i];pts2.push({x:p["x"]+p["var_x"]*Math.sin(t*cf1*p["mult_x"]),y:p["y"]+p["var_y"]*Math.cos(t*cf2*p["mult_y"])})}for(var f=0;f<data.length;f+=3){triangle(pts2[data[f]]["x"],pts2[data[f]]["y"],pts2[data[f+1]]["x"],pts2[data[f+1]]["y"],pts2[data[f+2]]["x"],pts2[data[f+2]]["y"]);if(dots&&!ctl){circle(pts2[data[f]]["x"],pts2[data[f]]["y"],size/50);circle(pts2[data[f+1]]["x"],pts2[data[f+1]]["y"],size/50);circle(pts2[data[f+2]]["x"],pts2[data[f+2]]["y"],size/50)}}strokeWeight(size/100);stroke(ccc);fill(bk,150);ww=width*!b1+-1*(!b1==0?-1:1)*size/2;hh=height*!b2+-1*(!b2==0?-1:1)*size/2;if(sym){beginShape();vertex(ww-size/5,hh);vertex(ww,hh-size/5);vertex(ww+size/5,hh);vertex(ww,hh+size/5);endShape(CLOSE)}else{circle(ww,hh,size/2.5)}fill(ccc);noStroke();circle(ww,hh,size/20)}}function keyPressed(){if(key=="b"){drw=!drw}}function mouseClicked(){time=!time}
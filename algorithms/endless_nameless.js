const MF=Math.floor,W=window,C={rects:[1,2,3,3,3,5,5,5,5,5,9,9,9,9,13,16,36,72],variability:.9,stops:[2,16],speed:7e-4,perp:.8,color:{groupCount:[1,2,3],pairCount:[1,12],groups:[{name:"two-colors",weight:3,pairs:[["#060","#0ff"],["#060","#ff0"],["#00f","#f0f"],["#0f0","#60f"],["#0f0","#f0f"],["#0ff","#60f"],["#0ff","#f00"],["#0ff","#f0f"],["#0ff","#ff0"],["#60f","#ff0"],["#60f","#f00"],["#f00","#f0f"],["#f0f","#ff0"]]},{name:"white+color",weight:1,pairs:[["#fff","#00f"],["#fff","#060"],["#fff","#0f0"],["#fff","#0ff"],["#fff","#60f"],["#fff","#f00"],["#fff","#f0f"]]},{name:"black+color",weight:1,pairs:[["#000","#00f"],["#000","#060"],["#000","#0f0"],["#000","#0ff"],["#000","#60f"],["#000","#f00"],["#000","#f0f"],["#000","#fff"]]}]}},Rnd={f:function(){let t,r,e=Uint32Array.from([0,1,r=t=2,3].map(f=>parseInt(tokenData.hash.substr(8*f+2,8),16)));return f=>(t=e[3],e[3]=e[2],e[2]=e[1],e[1]=r=e[0],t^=t<<11,e[0]^=t^t>>>8^r>>>19,e[0]/Math.pow(2,32))}(),b:f=>Rnd.f()<.5,pck:(f,t)=>{if(null!=t){var r,e=[];for(r in f){var n=f[r];-1==t.indexOf(n)&&e.push(n)}f=e}return f[MF(Rnd.f()*f.length)]},btw:(f,t,r,e)=>{var n=Rnd.f();e&&(e=Math.pow(n<.5?2*n:2*(1-n),e),n=n<.5?e/2:1-e/2);f+=n*(t-f);return r?MF(f):f},rng:(f,t,r)=>Rnd.btw(f[0],f[1],t,r)},shf=f=>{let t,r,e;for(e=f.length;e;e--)t=MF(Rnd.f()*e),r=f[e-1],f[e-1]=f[t],f[t]=r;return f},rct=(f,t,r,e)=>({x:f,y:t,w:r,h:e,a:r*e}),cmp=f=>{let t=Rnd.pck(C.rects);const r=C.variability,e=1/t,n=[rct(0,0,1,1)];let o,s,c,a;for(;1<t;t--){var{x:p,y:i,w:h,h:l}=n.pop();o=MF(h*l/e),s=r/o/2;var d=(1<o?Rnd.btw(1,o-1,1)/o:.5)+Rnd.btw(-s,s);a=l<=h==Rnd.f()<C.perp,a?(c=h*d,n.push(rct(p,i,c,l),rct(p+c,i,h-c,l))):(c=l*d,n.push(rct(p,i,h,c),rct(p,i+c,h,l-c))),n.sort((f,t)=>f.a-t.a)}return n},rst=f=>{let t=C.color;var r=t.groups.reduce((t,r)=>{for(let f=0;f<r.weight;f++)t.push(r);return t},[]);let e=[];for(let f=0;f<Rnd.pck(t.groupCount);f++)e.push(Rnd.pck(r,e));var n=Array.from(new Set(e.reduce((f,t)=>f.concat(t.pairs.map(f=>f.join("-"))),[]))).map(f=>f.split("-")),n=shf(n).slice(0,Rnd.rng(t.pairCount));rs=cmp(),rs.forEach(f=>{f.cs=Rnd.pck(n),f.n=2*MF(Rnd.rng(C.stops,1)/2)+1,f.hor=Rnd.b(),f.p=Rnd.f(),f.s=C.speed*(Rnd.b()?1:-1)})},rsz=f=>{const t=W.innerWidth,r=W.innerHeight,e=W.devicePixelRatio,n=cvs.style;ctx.scale(e,e),vw=cvs.width=Math.ceil(t*e),vh=cvs.height=Math.ceil(r*e),n.width=t+"px",n.height=r+"px"},upd=f=>{rs.forEach(t=>{t.p=(t.p+t.s+1)%1;let{x:f,y:r,w:e,h:n,p:o}=t,s;f*=vw,r*=vh,e*=vw,n*=vh;const c=[],a=[];var p=1/(2*t.n-2);for(let f=0;f<2*t.n-1;f++)c.push(t.cs[f%2]),a.push(f*p);t.hor?(s=r+o*n-n,grd(f,s,f,s+2*n,c,a,f,r,e,n)):(s=f+o*e-e,grd(s,r,s+2*e,r,c,a,f,r,e,n))})},grd=function(f,t,r,e,n,o,s,c,a,p){const i=ctx.createLinearGradient(f,t,r,e);for(var h in n)i.addColorStop(o[h],n[h]);ctx.fillStyle=i,ctx.strokeStyle=i,ctx.fillRect(s,c,a,p)};let cvs,ctx,vw,vh,rs;W.onload=f=>{cvs=document.querySelector("canvas"),ctx=cvs.getContext("2d"),W.onresize=W.onorientationchange=rsz,rsz(),setInterval(upd,1e3/60),rst()};
"use strict";{console.clear();const t=t=>new Float32Array(t),e=function(t){let e=t;return function(){return e^=e<<13,e^=e>>17,e^=e<<5,(e<0?1+~e:e)%1e3/1e3}}(parseInt(tokenData.hash.slice(0,16),16)),o=t=>t[Math.floor(e()*t.length)];e(),e();const s=4,n=60,r=[],i=[],c=[],l={};let a=0,h=0,f=0,u=0,x=!0,v=0;const y=e()>.15?1:0,d=y?1:0,g=y?[.8,.9,1]:[.2,.25,.3],p=y?".1,.1,.1":"0.,.05,.1",m=y?".5,.5,.5":".4,.5,.6",z=y?"1,.6,.3":"2.*.6,2.*.35,.15",R=o([1,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4]),w=e()>.5?1:.75;let b=o([0,15,15,15,15,15,15,100,200,220,250,300]);const A=e()>=.98?.02:0,P=e()>.95?.05:-.05,C=y&&e()>.98?1:0,D=y&&e()>.98?1:0,E=C?"brightness(0.9) contrast(1.35) grayscale(100%)":D?"brightness(0.9) contrast(1.3) sepia(100%)":"";console.log("mode:"+["night","day"][y]),console.log("model: "+["megalopolis","city","station","outpost"][R-1]),console.log("hue:"+b),console.log("black and white: "+(C?"true":"false")),console.log("sepia: "+(D?"true":"false")),console.log("multicolor:"+(A>0?"true":"false")),console.log("rotation: "+(P>0?"counter-clockwise":"clockwise"));const M=(t,e)=>{const o=document.querySelectorAll(t);for(const t of o)for(let o in e)t.style[o]=e[o]};M("html,body",{overflow:"hidden",position:"absolute",margin:0,padding:0,width:"100%",height:"100%"});const k={position:"absolute",padding:0,margin:0,left:0,top:0,width:"100%",height:"100%",cursor:"pointer",touchAction:"none",userSelect:"none"};(C||D)&&(k.filter=E),M("canvas",k);const _={x(t,e){t[12]+=t[0]*e,t[13]+=t[1]*e,t[14]+=t[2]*e},y(t,e){t[12]+=t[4]*e,t[13]+=t[5]*e,t[14]+=t[6]*e},z(t,e){t[12]+=t[8]*e,t[13]+=t[9]*e,t[14]+=t[10]*e},s(t,e){const o=Array.isArray(e),s=o?e[0]:e,n=o?e[1]:s,r=o?e[2]:s;t[0]*=s,t[1]*=s,t[2]*=s,t[3]*=s,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n,t[8]*=r,t[9]*=r,t[10]*=r,t[11]*=r},rx(t,e){const o=Math.PI*(e/180),s=Math.sin(o),n=Math.cos(o),r=t[4],i=t[5],c=t[6],l=t[7],a=t[8],h=t[9],f=t[10],u=t[11];t[4]=r*n+a*s,t[5]=i*n+h*s,t[6]=c*n+f*s,t[7]=l*n+u*s,t[8]=r*-s+a*n,t[9]=i*-s+h*n,t[10]=c*-s+f*n,t[11]=l*-s+u*n},ry(t,e){const o=Math.PI*(e/180),s=Math.sin(o),n=Math.cos(o),r=t[0],i=t[1],c=t[2],l=t[3],a=t[8],h=t[9],f=t[10],u=t[11];t[0]=r*n+a*-s,t[1]=i*n+h*-s,t[2]=c*n+f*-s,t[3]=l*n+u*-s,t[8]=r*s+a*n,t[9]=i*s+h*n,t[10]=c*s+f*n,t[11]=l*s+u*n},rz(t,e){const o=Math.PI*(e/180),s=Math.sin(o),n=Math.cos(o),r=t[0],i=t[1],c=t[2],l=t[3],a=t[4],h=t[5],f=t[6],u=t[7];t[0]=r*n+a*s,t[1]=i*n+h*s,t[2]=c*n+f*s,t[3]=l*n+u*s,t[4]=r*-s+a*n,t[5]=i*-s+h*n,t[6]=c*-s+f*n,t[7]=l*-s+u*n},hue(t,e){t[16]+=e,t[16]%=360},sat(t,e){this.col(t,e,17)},vhue(t,e){t[16]=e},vsat(t,e){t[17]=e},b(t,e){this.col(t,e,18)},col(t,e,o){t[o]+=e>0?e*(1-t[o]):e*t[o]},l(t,e){t[18]=e}},F=(t,e,o,s)=>{const n=N(t);for(const t in e)_[t](n,e[t]);n[22]=o,r.push(n),f+=s},S=(t,e)=>F(t,e,2,18),T=(t,e)=>F(t,e,1,36),I=t=>t[19],L=t=>(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])/(t[8]*t[8]+t[9]*t[9]+t[10]*t[10]),B=(t,e)=>{const o=N(t);o[19]++;for(const t in e)_[t](o,e[t]);return o},N=t=>[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15],t[16],t[17],t[18],t[19],t[20],t[21],t[22]],W=(t,e,o,s)=>{t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e,t[13]=o,t[14]=s,t[15]=1},H=(t,e)=>{c.length=0,r.length=0,f=0,l[t]([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0],e);do{const t=c.shift();void 0!==t&&i[t[21]](t)}while(c.length)},U=t=>(e,o)=>{(e=B(e,o))[21]=t,c.push(e)},Y=(t,o,s,n)=>(r,i)=>{r=B(r,i);let l=0;const a=e()*t;for(let t=0;t<n;t++)if(l+=o[t],a<=l)return r[21]=s[t],void c.push(r)},$=document.querySelector("canvas"),K=$.getContext("webgl");K.enable(K.DEPTH_TEST),K.enable(K.CULL_FACE);const O=()=>{a=$.width=$.offsetWidth,h=$.height=$.offsetHeight,K.viewport(0,0,K.drawingBufferWidth,K.drawingBufferHeight),st.proj(n),x=!1,Z.set(K.drawingBufferWidth,K.drawingBufferHeight)};window.addEventListener("resize",(()=>{x=!0}));const V={init(){this.ec=[],this.prevDiff=-1,this.x=0,this.y=0,this.z=0,this.dx=360*e(),this.dy=2===R?10:20*e()-5,this.xb=0,this.yb=0,this.sx=P,this.isDown=!1;const t=window.addEventListener;return t("pointermove",(t=>this.move(t)),!1),t("pointerdown",(t=>this.down(t)),!1),t("pointerup",(t=>this.up(t)),!1),t("pointerout",(t=>this.up(t)),!1),t("pointerleave",(t=>this.up(t)),!1),t("pointercancel",(t=>this.up(t)),!1),t("wheel",(t=>{if(t.ctrlKey)return!1;t.deltaY<0&&this.z<.025&&(this.z+=.005),t.deltaY>0&&this.z>-.035&&(this.z-=.005)})),this},down(t){this.sx=0,this.ec.push(t),this.move(t),this.xb=this.x,this.yb=this.y,this.isDown=!(this.ec.length>1),t.preventDefault()},up(t){for(let e=0;e<this.ec.length;e++)if(this.ec[e].pointerId==t.pointerId){this.ec.splice(e,1);break}this.ec.length<2&&(this.prevDiff=-1),this.isDown=!1},move(t){for(let e=0;e<this.ec.length;e++)if(t.pointerId==this.ec[e].pointerId){this.ec[e]=t;break}if(2===this.ec.length){const t=this.ec[0].clientX-this.ec[1].clientX,e=this.ec[0].clientY-this.ec[1].clientY,o=Math.sqrt(t*t+e*e);return this.prevDiff>0&&(o>this.prevDiff?this.z<.025&&(this.z+=5e-4):o<this.prevDiff&&this.z>-.035&&(this.z-=5e-4)),void(this.prevDiff=o)}this.x=t.clientX,this.y=t.clientY,this.isDown&&(this.dx+=this.x-this.xb,this.dy+=this.y-this.yb),t.preventDefault()}},j=(t,e,o)=>{const s=K.getUniformLocation(t,e);return{set:{"1f":t=>K.uniform1f(s,t),"2f":(t,e)=>K.uniform2f(s,t,e),"3f":(t,e=0,o=0)=>{!0===Array.isArray(t)?K.uniform3fv(s,t):K.uniform3f(s,t,e,o)},M4fv:t=>K.uniformMatrix4fv(s,!1,t)}[o]}},q=()=>{const e=j(Q,"camProj","M4fv"),o=j(Q,"camView","M4fv"),n=t(16),r=t(16);let i=ot.dx,c=ot.dy,l=0;const f=(t,e,o)=>t+=(e-t)*o;return{move(){l+=.1*(ot.z-l),ot.dy>45?ot.dy=45:ot.dy<-45&&(ot.dy=-45),i=f(i,ot.dx,.02),c=f(c,ot.dy,.06),W(n,0,0,120*l-s),_.rx(n,c),_.ry(n,i),o.set(n),ot.xb=ot.x,ot.yb=ot.y,et.set(0,d,60*l-1.5)},proj(t){const o=.01,s=1e4,n=o*Math.tan(t*Math.PI/360),i=n*(a/h);r[0]=2*o/(i+i),r[5]=2*o/(n+n),r[8]=0,r[9]=0,r[10]=-(s+o)/(s-o),r[11]=-1,r[14]=-200/(s-o),e.set(r)}}},X=(t,e,o,s,n,r)=>{if(null!==o){const t=K.createBuffer();K.bindBuffer(K.ARRAY_BUFFER,t),K.bufferData(K.ARRAY_BUFFER,o,K.STATIC_DRAW)}const i=K.getAttribLocation(t,e);K.enableVertexAttribArray(i),K.vertexAttribPointer(i,s,K.FLOAT,!1,n,r)},G=(t,e)=>{const o=K.createShader(e);if(K.shaderSource(o,t),K.compileShader(o),!K.getShaderParameter(o,K.COMPILE_STATUS))throw new Error(K.getShaderInfoLog(o));return o},J=(t,e)=>{const o=G(t,K.VERTEX_SHADER),s=G(e,K.FRAGMENT_SHADER),n=K.createProgram();return K.attachShader(n,o),K.attachShader(n,s),K.linkProgram(n),K.useProgram(n),n},Q=J("precision highp float;uniform mat4 camProj,camView;attribute vec3 aPosition,aNormal,aColor;varying vec4 vPosition;varying vec3 vNormal,vColor;vec3 hsv2rgb(vec3 c) {vec4 K=vec4(1.,2./3.,1./3.,3.);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,.0,1.),c.y);}void main() {vPosition=camView*vec4(aPosition,1.);gl_Position=camProj*vPosition;vNormal=normalize(vec3(camView*vec4(aNormal,.0)));vColor=hsv2rgb(aColor);}\t",`precision highp float;uniform float uTime;uniform vec2 uRes;uniform vec3 ulightPos;varying vec4 vPosition;varying vec3 vNormal,vColor;const vec3 uspecCol=vec3(${z});const vec3 udifCol=vec3(${m});const vec3 uambCol=vec3(${p});const float density=${y?.002:.01};float hash12(vec2 p) {vec3 p3=fract(vec3(p.xyx)*.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}void main() {vec3 lightDirection=normalize(ulightPos-vPosition.xyz);vec3 normal=normalize(vNormal);float spec=max(dot(reflect(-lightDirection,normal),normalize(-vPosition.xyz)),0.00001);float difW=max(dot(normal,lightDirection),0.0);vec3 lightW=.75*uspecCol*pow(spec,.25)+udifCol*difW+uspecCol*pow(spec,12.2);vec3 color=vColor*lightW*(1.25-hash12(gl_FragCoord.xy*.304+uTime*.1)*.25);gl_FragColor=mix(vec4(${g[0]},${g[1]},${g[2]},1.0),vec4(color,1.),exp2(-density*pow(gl_FragCoord.z/gl_FragCoord.w,3.)));}\t`),Z=j(Q,"uRes","2f"),tt=j(Q,"uTime","1f"),et=j(Q,"ulightPos","3f"),ot=V.init(),st=q(),nt=()=>{u=f;const e=t(9*f),o=.5,s=-o,n=[[s,s,s],[s,o,s],[o,s,s],[o,o,s],[o,s,o],[o,o,o],[s,s,o],[s,o,o],[s,s,o],[s,s,s],[o,s,o],[o,s,s],[s,o,s],[s,o,o],[o,o,s],[o,o,o],[s,s,s],[s,s,o],[s,o,s],[s,o,o],[o,o,s],[o,o,o],[o,s,s],[o,s,o]],i=[[s,s,s],[0,o,0],[o,s,s],[o,s,s],[0,o,0],[o,s,o],[o,s,o],[0,o,0],[s,s,o],[s,s,o],[0,o,0],[s,s,s],[o,s,s],[s,s,o],[s,s,s],[o,s,s],[o,s,o],[s,s,o]],c=(t,e,o)=>{const s=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],i=o[0]-t[0],c=o[1]-t[1],l=o[2]-t[2],a=n*l-r*c,h=r*i-s*l,f=s*c-n*i,u=Math.sqrt(a*a+h*h+f*f);return[a/u,h/u,f/u]},l=function(t,e){const o=t[0],s=t[1],n=t[2];return[o*e[0]+s*e[4]+n*e[8]+e[12],o*e[1]+s*e[5]+n*e[9]+e[13],o*e[2]+s*e[6]+n*e[10]+e[14]]};let a=0;const h=(t,o,s,n,r)=>{const i=n[16]/360,c=n[17],l=n[18];e.set([t[0],t[1],t[2],r[0],r[1],r[2],i,c,l,o[0],o[1],o[2],r[0],r[1],r[2],i,c,l,s[0],s[1],s[2],r[0],r[1],r[2],i,c,l],a),a+=27},x=(t,e,o)=>{const s=l(t[e+0],o),n=l(t[e+1],o),r=l(t[e+2],o),i=l(t[e+3],o);return[s,n,r,i,c(s,n,i)]};for(let t=0;t<r.length;t++){const e=r[t];if(1===e[22])for(let t=0;t<24;t+=4){const[o,s,r,i,c]=x(n,t,e);h(o,s,i,e,c),h(o,i,r,e,c)}else if(2===e[22])for(let t=0;t<18;t+=3){const o=l(i[t+0],e),s=l(i[t+1],e),n=l(i[t+2],e);h(o,s,n,e,c(o,s,n))}}X(Q,"aPosition",e,3,36,0),X(Q,"aNormal",null,3,36,12),X(Q,"aColor",null,3,36,24)},rt=()=>{x&&O(),K.clearColor(g[0],g[1],g[2],1),K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),st.move(),tt.set(v++),u<f&&(u+=18),K.drawArrays(K.TRIANGLES,0,u),K.drawArrays(K.LINE_LOOP,0,u)},it=()=>{requestAnimationFrame(it),ot.dx+=ot.sx,rt()},ct=()=>{H("start",{s:1}),nt(r)},lt=t=>{i.length=0;for(const e in t){const o=t[e];if(Array.isArray(o)){let t=0;const s=[],n=[];for(let e=0;e<o.length;e+=2)t+=o[e],i.push(o[e+1]),s.push(o[e]),n.push(i.length-1);l[e]=Y(t,s,n,n.length)}else i.push(o),l[e]=U(i.length-1)}ct(),O();for(let t=0;t<10;t++)rt();it()};lt({start(t){T(t,{y:-105,s:200,l:0}),1===R?(l.R1(t,{rx:90,z:-.8,s:6}),l.R1(t,{rx:-90,rz:180,z:-.8,s:6})):l.R1(t,{rx:90,s:6}),T(t,{y:-105})},R1:[1,t=>{if(1===R){if(I(t)>7)return;l.R1(t,{x:-.25*w,y:.25*w,s:.5,rz:90}),l.R1(t,{x:.25,y:-.25,s:.5}),l.R1(t,{x:-.25,y:-.25,s:[.5,.5,1.2],rz:90}),l.R1(t,{x:.25,y:.25,s:[.5,.5,1.2],rz:90}),l.block(t)}else if(2===R){if(I(t)>7)return;l.R1(t,{x:-.25*w,y:.25*w,s:.5,rz:90}),l.R1(t,{x:.25,y:-.25,s:.5}),l.R1(t,{x:-.25,y:-.25,s:[.5,.5,1.1],rz:-90}),l.R1(t,{x:.25,y:.25,s:[.5,.5,1.2]}),l.block(t)}else if(3===R){if(I(t)>5)return;l.R1(t,{x:-.25,y:.15,s:.5,rz:180}),l.R1(t,{x:.25*w,y:-.15*w,s:.5}),l.R1(t,{x:-.25,y:-.15,s:[.5,.5,1.2],rz:90}),l.R1(t,{x:.15,y:.15,s:[.5,.5,1.6],rz:90}),l.block(t,{})}else if(4===R){if(I(t)>4)return;l.R1(t,{x:-.1,y:.1,s:.5,rz:180}),l.R1(t,{x:.1*w,y:-.1*w,s:.5}),l.R1(t,{x:-.1,y:-.1,s:[.5,.5,1.2],rz:90}),l.R1(t,{x:.1,y:.1,s:[.5,.5,1.6],rz:90}),l.block(t,{})}},1,t=>{if(1===R){if(I(t)>7)return;l.R1(t,{x:-.25,y:.25,z:.1,s:[.5,.5,1.1]}),l.R1(t,{x:.25,y:-.25,s:.5,rz:90}),l.R1(t,{x:-.25,y:-.25,s:[.5,.5,1.3],rz:0}),l.block(t)}else if(2===R){if(I(t)>7)return;l.R1(t,{x:-.25,y:.25,s:[.5,.5,1.2],rz:-90}),l.R1(t,{x:.25,y:-.25,s:.5,rz:90}),l.R1(t,{x:.25,y:.25,z:-.1,s:[.5,.5,1.4]}),l.block(t)}else if(3===R){if(I(t)>8)return;l.R1(t,{x:-.1,z:.1,s:[.5,.5,1.1]}),l.R1(t,{x:.1,z:-.1,s:.5,rz:90}),l.R1(t,{x:-.1,z:-.1,s:[.5,.5,1.3],rz:180}),l.block(t)}else if(4===R){if(I(t)>5)return;l.R1(t,{x:-.1,z:.1,s:[.5,.5,1.1]}),l.R1(t,{x:.1,z:-.1,s:.5,rz:90}),l.R1(t,{x:-.1,z:-.1,s:[.5,.5,1.3],rz:180}),l.block(t)}}],block:[1,t=>{T(t,{x:-.25,y:-.25,s:[.48,.48,.1]})},1,t=>{const e=L(t);S(t,{x:-.25,y:-.25,z:.7*-e,rx:-90,s:[.48,e,.48],sat:.8,hue:30})},.5,t=>{for(let e=-.24;e<=.24;e+=.048)for(let o=-.24;o<=.24;o+=.048)T(t,{x:e-.5,y:o-.5,s:[.0337,.0337,.0543],hue:b+=A,sat:1})},1,t=>{if(L(t)>.1)T(t,{x:-.25,y:-.25,s:[.48,.48,.1]});else{const e=t[13]>0?-1:1;for(let o=0;o<=.05;o+=.008){const s=e<1?30*o+1:.5-(30*(.05-o)+1);S(t,{x:-.25,y:-.25,z:o,rx:90*e,s:[.51*s,.01,.51*s],sat:.8,hue:b+180})}}},1,t=>{l.frame(t,{x:-.25,y:-.25,s:[.48,.48,.1]})}],frame(t){const e=t[13]>0?.5:1;T(t,{x:-.5,z:-.5,s:[.05,.95,.05],l:e}),T(t,{y:-.5,z:-.5,s:[1.05,.05,.05],l:e}),T(t,{x:.5,z:-.5,s:[.05,.95,.05],l:e}),T(t,{y:.5,z:-.5,s:[1.05,.05,.05],l:e})}}),document.addEventListener("keydown",(function(t){" "===t.key&&(t.preventDefault(),u=0)}),!1)}